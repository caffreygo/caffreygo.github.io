"use strict";(self.webpackChunkblog=self.webpackChunkblog||[]).push([[2592],{4833:(n,s,a)=>{a.r(s),a.d(s,{data:()=>p});const p={key:"v-9b3f1cc0",path:"/VueJs3/section2/chapter6.html",title:"åŸå§‹å€¼çš„å“åº”å¼æ–¹æ¡ˆ",lang:"zh-CN",frontmatter:{},excerpt:"",headers:[{level:2,title:"å¼•å…¥ ref çš„æ¦‚å¿µ",slug:"å¼•å…¥-ref-çš„æ¦‚å¿µ",children:[]},{level:2,title:"å“åº”ä¸¢å¤±é—®é¢˜",slug:"å“åº”ä¸¢å¤±é—®é¢˜",children:[{level:3,title:"toRef",slug:"toref",children:[]},{level:3,title:"toRefs",slug:"torefs",children:[]}]},{level:2,title:"è‡ªåŠ¨è„± ref",slug:"è‡ªåŠ¨è„±-ref",children:[]}],filePathRelative:"VueJs3/section2/chapter6.md",git:{updatedTime:1652700162e3,contributors:[{name:"Jinrui Chen",email:"jinrui@kooboo.cn",commits:1}]}}},7285:(n,s,a)=>{a.r(s),a.d(s,{default:()=>e});const p=(0,a(6252).uE)('<h1 id="åŸå§‹å€¼çš„å“åº”å¼æ–¹æ¡ˆ" tabindex="-1"><a class="header-anchor" href="#åŸå§‹å€¼çš„å“åº”å¼æ–¹æ¡ˆ" aria-hidden="true">#</a> åŸå§‹å€¼çš„å“åº”å¼æ–¹æ¡ˆ</h1><p>ğŸ”– åŸå§‹å€¼æŒ‡çš„æ˜¯ Booleanã€Numberã€BigIntã€Stringã€Symbolã€undefined å’Œ null ç­‰ç±»å‹çš„å€¼ã€‚</p><ol><li>åœ¨ JavaScript ä¸­ï¼ŒåŸå§‹å€¼æ˜¯æŒ‰å€¼ä¼ é€’çš„ï¼Œè€ŒéæŒ‰å¼•ç”¨ä¼ é€’ã€‚è¿™æ„å‘³ç€ï¼Œå¦‚æœä¸€ä¸ªå‡½æ•°æ¥æ”¶åŸå§‹å€¼ä½œä¸ºå‚æ•°ï¼Œé‚£ä¹ˆå½¢å‚ä¸å®å‚ä¹‹é—´æ²¡æœ‰å¼•ç”¨å…³ç³»ï¼Œå®ƒä»¬æ˜¯ä¸¤ä¸ªå®Œå…¨ç‹¬ç«‹çš„å€¼ï¼Œå¯¹å½¢å‚çš„ä¿®æ”¹ä¸ä¼šå½±å“å®å‚ã€‚</li><li>å¦å¤– JavaScript ä¸­çš„ Proxy æ— æ³•æä¾›å¯¹åŸå§‹å€¼çš„ä»£ç†ï¼Œå› æ­¤æƒ³è¦å°†åŸå§‹å€¼å˜æˆå“åº”å¼æ•°æ®ï¼Œå°±å¿…é¡»å¯¹å…¶åšä¸€å±‚åŒ…è£¹ã€‚</li></ol><h2 id="å¼•å…¥-ref-çš„æ¦‚å¿µ" tabindex="-1"><a class="header-anchor" href="#å¼•å…¥-ref-çš„æ¦‚å¿µ" aria-hidden="true">#</a> å¼•å…¥ ref çš„æ¦‚å¿µ</h2><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> wrapper <span class="token operator">=</span> <span class="token punctuation">{</span>\n\tvalue<span class="token operator">:</span> <span class="token string">&#39;vue&#39;</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">const</span> name <span class="token operator">=</span> <span class="token function">reactive</span><span class="token punctuation">(</span>wrapper<span class="token punctuation">)</span>\n<span class="token function">effect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>name<span class="token punctuation">.</span>vlaue<span class="token punctuation">)</span><span class="token punctuation">)</span>\nname<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token string">&#39;vue3&#39;</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><div class="custom-container warning"><p class="custom-container-title">å¦‚æœä½¿ç”¨éåŸå§‹å€¼å»â€œåŒ…è£¹â€åŸå§‹å€¼ï¼Œä¼šå¯¼è‡´ä¸€äº›é—®é¢˜ï¼š</p><ul><li>ç”¨æˆ·ä¸ºäº†åˆ›å»ºä¸€ä¸ªå“åº”å¼çš„åŸå§‹å€¼ï¼Œä¸å¾—ä¸é¡ºå¸¦åˆ›å»ºä¸€ä¸ªåŒ…è£¹å¯¹è±¡ï¼›</li><li>åŒ…è£¹å¯¹è±¡ç”±ç”¨æˆ·è‡ªå®šä¹‰ï¼Œè€Œè¿™æ„å‘³ç€ä¸è§„èŒƒã€‚ç”¨æˆ·å¯ä»¥éšæ„å‘½åï¼Œä¾‹å¦‚ wrapper.valueï¼Œ wrapper.val éƒ½æ˜¯å¯ä»¥çš„ã€‚</li></ul></div><p>ğŸš€ ä¸ºäº†è§£å†³ä»¥ä¸Šè¿™ä¸¤ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥å°è£…ä¸€ä¸ªå‡½æ•°æ¥å¤„ç†ã€‚åŒæ—¶ï¼Œä¸ºäº†åŒºåˆ† refVal åˆ°åº•æ˜¯åŸå§‹å€¼çš„åŒ…è£¹å¯¹è±¡ï¼Œè¿˜æ˜¯ä¸€ä¸ªéåŸå§‹å€¼çš„å“åº”å¼æ•°æ®ï¼Œæˆ‘ä»¬ä¸ºå…¶è¡¥å……äº†ä¸€ä¸ªå±æ€§ï¼š</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// å°è£… ref å‡½æ•°ä¸“é—¨å¤„ç†åŸå§‹å€¼çš„å“åº”å¼å¤„ç†1</span>\n<span class="token keyword">function</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token parameter">val</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token keyword">const</span> wrapper <span class="token operator">=</span> <span class="token punctuation">{</span>\n    value<span class="token operator">:</span> val\n  <span class="token punctuation">}</span>\n\t<span class="token comment">// ä½¿ç”¨ Object.defineProperty åœ¨ wrapper å¯¹è±¡ä¸Šå®šä¹‰ä¸€ä¸ªä¸å¯æšä¸¾çš„å±æ€§ __v_isRefï¼Œå¹¶ä¸”å€¼ä¸º true</span>\n  Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>wrapper<span class="token punctuation">,</span> <span class="token string">&#39;__v_isRef&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>\n    value<span class="token operator">:</span> <span class="token boolean">true</span>\n  <span class="token punctuation">}</span><span class="token punctuation">)</span>\n  <span class="token comment">// é€šè¿‡ value å±æ€§è®¿é—®åŸå§‹å€¼</span>\n  <span class="token keyword">return</span> <span class="token function">reactive</span><span class="token punctuation">(</span>wrapper<span class="token punctuation">)</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">function</span> <span class="token function">isRef</span><span class="token punctuation">(</span><span class="token parameter">val</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token keyword">return</span> val<span class="token punctuation">.</span>__v_isRef <span class="token operator">===</span> <span class="token boolean">true</span>\n<span class="token punctuation">}</span>\n<span class="token comment">// åŸå§‹å€¼çš„åŒ…è£¹å¯¹è±¡</span>\n<span class="token keyword">const</span> refVal1 <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>\n<span class="token comment">// éåŸå§‹å€¼çš„å“åº”å¼æ•°æ®</span>\n<span class="token keyword">const</span> refVal2 <span class="token operator">=</span> <span class="token function">reactive</span><span class="token punctuation">(</span><span class="token punctuation">{</span> value<span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>\n\nconsole<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">isRef</span><span class="token punctuation">(</span>refVal1<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment">// true</span>\nconsole<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">isRef</span><span class="token punctuation">(</span>refVal2<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment">// false</span>\n\n<span class="token function">effect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>\n  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>refVal1<span class="token punctuation">.</span>value<span class="token punctuation">)</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span>\n\nrefVal1<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token number">2</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br></div></div><h2 id="å“åº”ä¸¢å¤±é—®é¢˜" tabindex="-1"><a class="header-anchor" href="#å“åº”ä¸¢å¤±é—®é¢˜" aria-hidden="true">#</a> å“åº”ä¸¢å¤±é—®é¢˜</h2><p>ğŸ› å±•å¼€è¿ç®—ç¬¦ï¼ˆ...ï¼‰ä¼šå¯¼è‡´æ•°æ®çš„å“åº”ä¸¢å¤±ï¼Œè€Œè¿™ä¸ªæ“ä½œæˆ‘ä»¬åœ¨ setup è¿”å›æ—¶æ˜¯ç»å¸¸ä½¿ç”¨çš„ï¼Œè¿”å›çš„æ–°å¯¹è±¡å¦‚æœå˜æˆäº†æ™®é€šå¯¹è±¡ï¼Œå°±å¤±å»äº†å“åº”èƒ½åŠ›ã€‚</p><p>æˆ‘ä»¬è¦å®ç°ï¼šåœ¨å‰¯ä½œç”¨å‡½æ•°å†…ï¼Œå³ä½¿é€šè¿‡æ™®é€šå¯¹è±¡ newObj æ¥è®¿é—®å±æ€§å€¼ï¼Œä¹Ÿèƒ½è¿‡å»ºç«‹å“åº”å¼è”ç³»ï¼š</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// obj æ˜¯å“åº”å¼æ•°æ®</span>\n<span class="token keyword">const</span> obj <span class="token operator">=</span> <span class="token function">reactive</span><span class="token punctuation">(</span><span class="token punctuation">{</span>foo<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> bar<span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">)</span>\n\n<span class="token comment">// newObj å¯¹è±¡ä¸‹å…·æœ‰ä¸ obj å¯¹è±¡åŒåçš„å±æ€§ï¼Œå¹¶ä¸”æ¯ä¸ªå±æ€§å€¼éƒ½æ˜¯ä¸€ä¸ªå¯¹è±¡</span>\n<span class="token comment">// è¯¥å¯¹è±¡å…·æœ‰ä¸€ä¸ªè®¿é—®å™¨å±æ€§ valueï¼Œå½“è¯»å– value çš„å€¼æ—¶ï¼Œå…¶å®è¯»å–çš„æ˜¯ obj å¯¹è±¡ç›¸åº”å±æ€§çš„å€¼</span>\n<span class="token keyword">const</span> newObj <span class="token operator">=</span> <span class="token punctuation">{</span>\n  foo<span class="token operator">:</span> <span class="token punctuation">{</span>\n    <span class="token keyword">get</span> <span class="token function">value</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      <span class="token keyword">return</span> obj<span class="token punctuation">.</span>foo\n    <span class="token punctuation">}</span>\n  <span class="token punctuation">}</span><span class="token punctuation">,</span>\n  bar<span class="token operator">:</span> <span class="token punctuation">{</span>\n    <span class="token keyword">get</span> <span class="token function">value</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      <span class="token keyword">return</span> obj<span class="token punctuation">.</span>bar\n    <span class="token punctuation">}</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token function">effect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>\n  <span class="token comment">// åœ¨å‰¯ä½œç”¨å‡½æ•°å†…ä½¿ç”¨æ–°å¯¹è±¡ newObj è¯»å– foo å±æ€§å€¼</span>\n  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>newObj<span class="token punctuation">.</span>foo<span class="token punctuation">)</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span>\n\n<span class="token comment">// è¿™æ—¶èƒ½å¤Ÿè§¦å‘å“åº”</span>\nobj<span class="token punctuation">.</span>foo <span class="token operator">=</span> <span class="token number">100</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br></div></div><p>åœ¨å‰¯ä½œç”¨å‡½æ•°å†…è¯»å– newObj.foo æ—¶ï¼Œç­‰ä»·äºé—´æ¥è¯»å–äº† obj.foo çš„å€¼ï¼Œè¿™æ ·å“åº”å¼æ•°æ®è‡ªç„¶èƒ½å¤Ÿä¸å‰¯ä½œç”¨å‡½æ•°å»ºç«‹å“åº”è”ç³»ã€‚</p><h3 id="toref" tabindex="-1"><a class="header-anchor" href="#toref" aria-hidden="true">#</a> toRef</h3><p>toRef å‡½æ•°æ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•° obj æ˜¯ä¸€ä¸ªå“åº”å¼æ•°æ®ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯ obj å¯¹è±¡çš„ä¸€ä¸ªé”®ã€‚è¯¥å‡½æ•°ä¼šè¿”å›ä¸€ä¸ª wrapper å¯¹è±¡ï¼›</p><p>ğŸš€ ä¸ºäº†æ¦‚å¿µä¸Šçš„ç»Ÿä¸€ï¼Œæˆ‘ä»¬ä¼šå°†é€šè¿‡ toRef æˆ– toRefs è½¬æ¢åå¾—åˆ°çš„ç»“æœè§†ä¸ºçœŸæ­£çš„ ref æ•°æ®ï¼Œå› æ­¤æˆ‘ä»¬é€šè¿‡ä¸ºå…¶å¢åŠ äº† __v_isRef å±æ€§çš„å®šä¹‰ã€‚</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">toRef</span><span class="token punctuation">(</span><span class="token parameter">obj<span class="token punctuation">,</span> key</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token comment">// æ¯ä¸ªå±æ€§éƒ½æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œé€šè¿‡å±æ€§è®¿é—®å™¨è·å–ï¼Œä»è€Œè§¦å‘ä»£ç†å¯¹è±¡çš„ get æ‹¦æˆª</span>\n  <span class="token keyword">const</span> wrapper <span class="token operator">=</span> <span class="token punctuation">{</span>\n    <span class="token keyword">get</span> <span class="token function">value</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      <span class="token keyword">return</span> obj<span class="token punctuation">[</span>key<span class="token punctuation">]</span>\n    <span class="token punctuation">}</span><span class="token punctuation">,</span>\n    <span class="token comment">// å…è®¸è®¾ç½®å€¼</span>\n    <span class="token keyword">set</span> <span class="token function">value</span><span class="token punctuation">(</span><span class="token parameter">val</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      obj<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> val\n    <span class="token punctuation">}</span>\n  <span class="token punctuation">}</span>\n  Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>wrapper<span class="token punctuation">,</span> <span class="token string">&#39;__v_isRef&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>\n    value<span class="token operator">:</span> <span class="token boolean">true</span>\n  <span class="token punctuation">}</span><span class="token punctuation">)</span>\n\n  <span class="token keyword">return</span> wrapper\n<span class="token punctuation">}</span>\n\n<span class="token comment">// const obj = reactive({ foo: 1, bar: 2 })</span>\n<span class="token comment">// const refFoo = toRef(obj, &#39;foo&#39;)</span>\n<span class="token comment">// console.log(refFoo.value)</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><div class="custom-container tip"><p class="custom-container-title">toRef</p><ul><li>å®ç°åŸå§‹å€¼çš„å“åº”å¼æ–¹æ¡ˆ</li><li>è§£å†³å“åº”å¼ä¸¢å¤±é—®é¢˜</li></ul></div><h3 id="torefs" tabindex="-1"><a class="header-anchor" href="#torefs" aria-hidden="true">#</a> toRefs</h3><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">toRefs</span><span class="token punctuation">(</span><span class="token parameter">obj</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>\n  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> key <span class="token keyword">in</span> obj<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    ret<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">toRef</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> key<span class="token punctuation">)</span>\n  <span class="token punctuation">}</span>\n  <span class="token keyword">return</span> res\n<span class="token punctuation">}</span>\n\n<span class="token comment">// const obj = reactive({ foo: 1, bar: 2 })</span>\n<span class="token comment">// const newObj = { ...toRefs(obj) }</span>\n<span class="token comment">// console.log(newObj.foo.value)</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h2 id="è‡ªåŠ¨è„±-ref" tabindex="-1"><a class="header-anchor" href="#è‡ªåŠ¨è„±-ref" aria-hidden="true">#</a> è‡ªåŠ¨è„± ref</h2><p>ğŸ”– ç›®å‰çš„ ref æ•°æ®éœ€è¦é€šè¿‡ value å±æ€§è®¿é—®ï¼Œå¢åŠ äº†ç”¨æˆ·çš„å¿ƒæ™ºè´Ÿæ‹…ã€‚</p><p>æ‰€è°“è‡ªåŠ¨è„± ref ï¼ŒæŒ‡çš„æ˜¯å±æ€§çš„è®¿é—®è¡Œä¸ºï¼Œå³å¦‚æœè¯»å–çš„å±æ€§æ˜¯ä¸€ä¸ª refï¼Œåˆ™ç›´æ¥å°†è¯¥ ref å¯¹åº”çš„ value å±æ€§å€¼è¿”å›ã€‚åŒæ ·çš„ï¼Œè®¾ç½®å±æ€§çš„å€¼ä¹Ÿåº”è¯¥æœ‰è‡ªåŠ¨ä¸º ref è®¾ç½®å€¼çš„èƒ½åŠ›ã€‚</p><p>ğŸš€ è¦å®ç°è¿™ä¸ªåŠŸèƒ½ï¼Œéœ€è¦ä½¿ç”¨ Proxy ä¸º newObj åˆ›å»ºä¸€ä¸ªä»£ç†å¯¹è±¡ï¼Œé€šè¿‡ä»£ç†æ¥å®ç°æœ€ç»ˆç›®æ ‡ï¼š</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">proxyRefs</span><span class="token punctuation">(</span><span class="token parameter">target</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> <span class="token punctuation">{</span>\n    <span class="token function">get</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> key<span class="token punctuation">,</span> receiver<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      <span class="token keyword">const</span> value <span class="token operator">=</span> Reflect<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> key<span class="token punctuation">,</span> receiver<span class="token punctuation">)</span>\n      <span class="token comment">// è‡ªåŠ¨è„± ref çš„å®ç°ï¼šå¦‚æœè¯»å–çš„å€¼æ˜¯ refï¼Œåˆ™è¿”å›å®ƒçš„ value å±æ€§å€¼</span>\n      <span class="token keyword">return</span> value<span class="token punctuation">.</span>__v_isRef <span class="token operator">?</span> value<span class="token punctuation">.</span>value <span class="token operator">:</span> value\n    <span class="token punctuation">}</span><span class="token punctuation">,</span>\n    <span class="token function">set</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> key<span class="token punctuation">,</span> newValue<span class="token punctuation">,</span> receiver<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      <span class="token comment">// é€šè¿‡ target è¯»å–çœŸå®å€¼</span>\n      <span class="token keyword">const</span> value <span class="token operator">=</span> target<span class="token punctuation">[</span>key<span class="token punctuation">]</span>\n      <span class="token comment">// å¦‚æœå€¼æ˜¯ Refï¼Œåˆ™è®¾ç½®å¯¹åº”çš„ value å±æ€§å€¼</span>\n      <span class="token keyword">if</span> <span class="token punctuation">(</span>value<span class="token punctuation">.</span>__v_isRef<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        value<span class="token punctuation">.</span>value <span class="token operator">=</span> newValue\n        <span class="token keyword">return</span> <span class="token boolean">true</span>\n      <span class="token punctuation">}</span>\n      <span class="token keyword">return</span> Reflect<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> key<span class="token punctuation">,</span> newValue<span class="token punctuation">,</span> receiver<span class="token punctuation">)</span>\n    <span class="token punctuation">}</span>\n  <span class="token punctuation">}</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">const</span> newObj <span class="token operator">=</span> <span class="token function">proxyRefs</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token operator">...</span><span class="token function">toRefs</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><p>åœ¨ Vue.js ä¸­ï¼Œreactive ä¹ŸåŒæ ·å®ç°äº† è„± ref çš„èƒ½åŠ›ï¼š</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> count <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>\n<span class="token keyword">const</span> obj <span class="token operator">=</span> <span class="token function">reactive</span><span class="token punctuation">(</span><span class="token punctuation">{</span> count <span class="token punctuation">}</span><span class="token punctuation">)</span>\n\nobj<span class="token punctuation">.</span>count <span class="token comment">// 0</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div>',27),e={render:function(n,s){return p}}}}]);