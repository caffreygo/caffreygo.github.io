"use strict";(self.webpackChunkblog=self.webpackChunkblog||[]).push([[9434],{5594:(n,s,a)=>{a.r(s),a.d(s,{data:()=>p});const p={key:"v-0df0b480",path:"/VueJs3/section3/chapter7.html",title:"æ¸²æŸ“å™¨çš„è®¾è®¡",lang:"zh-CN",frontmatter:{},excerpt:"",headers:[{level:2,title:"æ¸²æŸ“å™¨ä¸å“åº”ç³»ç»Ÿç»“åˆ",slug:"æ¸²æŸ“å™¨ä¸å“åº”ç³»ç»Ÿç»“åˆ",children:[]},{level:2,title:"æ¸²æŸ“å™¨çš„åŸºæœ¬æ¦‚å¿µ",slug:"æ¸²æŸ“å™¨çš„åŸºæœ¬æ¦‚å¿µ",children:[]},{level:2,title:"è‡ªå®šä¹‰æ¸²æŸ“å™¨",slug:"è‡ªå®šä¹‰æ¸²æŸ“å™¨",children:[{level:3,title:"æµè§ˆå™¨æ¸²æŸ“å™¨",slug:"æµè§ˆå™¨æ¸²æŸ“å™¨",children:[]},{level:3,title:"è‡ªå®šä¹‰æ¸²æŸ“å™¨",slug:"è‡ªå®šä¹‰æ¸²æŸ“å™¨-1",children:[]}]},{level:2,title:"æ€»ç»“",slug:"æ€»ç»“",children:[]}],filePathRelative:"VueJs3/section3/chapter7.md",git:{updatedTime:1653975889e3,contributors:[{name:"Jinrui Chen",email:"jinrui@kooboo.cn",commits:2},{name:"Jerry Chen",email:"caffreygo@163.com",commits:1}]}}},2817:(n,s,a)=>{a.r(s),a.d(s,{default:()=>t});const p=(0,a(6252).uE)('<h1 id="æ¸²æŸ“å™¨çš„è®¾è®¡" tabindex="-1"><a class="header-anchor" href="#æ¸²æŸ“å™¨çš„è®¾è®¡" aria-hidden="true">#</a> æ¸²æŸ“å™¨çš„è®¾è®¡</h1><h2 id="æ¸²æŸ“å™¨ä¸å“åº”ç³»ç»Ÿç»“åˆ" tabindex="-1"><a class="header-anchor" href="#æ¸²æŸ“å™¨ä¸å“åº”ç³»ç»Ÿç»“åˆ" aria-hidden="true">#</a> æ¸²æŸ“å™¨ä¸å“åº”ç³»ç»Ÿç»“åˆ</h2><p>ğŸ“ æ¸²æŸ“å™¨æ˜¯ç”¨æ¥æ‰§è¡Œ<strong>æ¸²æŸ“ä»»åŠ¡</strong>çš„ã€‚åœ¨æµè§ˆå™¨å¹³å°ä¸Šï¼Œç”¨å®ƒæ¥æ¸²æŸ“çœŸå® DOM å…ƒç´ ã€‚</p><p>æ¸²æŸ“å™¨ä¸ä»…èƒ½å¤Ÿæ¸²æŸ“çœŸå® DOM å…ƒç´ ï¼Œå®ƒè¿˜æ˜¯æ¡†æ¶è·¨å¹³å°èƒ½åŠ›çš„å…³é”®ã€‚åœ¨é™å®šçš„ DOM å¹³å°ï¼Œæ¸²æŸ“å™¨èƒ½å¤Ÿæ¸²æŸ“ä¸€ä¸ªçœŸå® DOMï¼Œé‚£ä¹ˆä¸‹é¢è¿™ä¸ª renderer å‡½æ•°å°±æ˜¯ä¸€ä¸ªåˆæ ¼çš„æ¸²æŸ“å™¨ã€‚@vue/reactivity æä¾›äº† IIFE æ¨¡å—æ ¼å¼ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥å¼•ç”¨ï¼š</p><div class="language-html ext-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>app<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>https://unpkg.com/@vue/reactivity@3.0.5/dist/reactivity.global.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">\n    <span class="token keyword">const</span> <span class="token punctuation">{</span> effect<span class="token punctuation">,</span> ref <span class="token punctuation">}</span> <span class="token operator">=</span> VueReactivity\n    <span class="token comment">// æ¸²æŸ“å™¨</span>\n    <span class="token keyword">function</span> <span class="token function">renderer</span><span class="token punctuation">(</span><span class="token parameter">domString<span class="token punctuation">,</span> container</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        container<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> domString\n    <span class="token punctuation">}</span>\n    <span class="token comment">// åˆ©ç”¨å“åº”ç³»ç»Ÿå£°æ˜ä¸€ä¸ªåŸå§‹å€¼å“åº”æ•°æ®</span>\n    <span class="token keyword">const</span> count <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>\n    <span class="token comment">// åˆ©ç”¨å“åº”ç³»ç»Ÿå¯¹ count è¿›è¡Œä¾èµ–æ”¶é›†</span>\n    <span class="token function">effect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>\n        <span class="token function">renderer</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">&lt;h1&gt;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>count<span class="token punctuation">.</span>value<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&lt;/h1&gt;</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&#39;app&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>\n    <span class="token punctuation">}</span><span class="token punctuation">)</span>\n    <span class="token comment">// è§¦å‘å‰¯ä½œç”¨å‡½æ•°æ‰§è¡Œ</span>\n    <span class="token function">setInterval</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>\n        count<span class="token punctuation">.</span>value<span class="token operator">++</span>\n    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span>\n</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><h2 id="æ¸²æŸ“å™¨çš„åŸºæœ¬æ¦‚å¿µ" tabindex="-1"><a class="header-anchor" href="#æ¸²æŸ“å™¨çš„åŸºæœ¬æ¦‚å¿µ" aria-hidden="true">#</a> æ¸²æŸ“å™¨çš„åŸºæœ¬æ¦‚å¿µ</h2><details class="custom-container details"><summary>å…³é”®è¯</summary><ul><li>æ¸²æŸ“å™¨ï¼ˆrendererï¼‰ï¼šæŠŠè™šæ‹Ÿ DOM æ¸²æŸ“ä¸ºç‰¹å®šå¹³å°ä¸Šçš„çœŸå®å…ƒç´ </li><li>æ¸²æŸ“ï¼ˆrenderï¼‰ï¼šåŠ¨è¯ï¼Œæ¸²æŸ“</li><li>è™šæ‹Ÿ DOMï¼ˆvirtual DOMï¼Œvdomï¼‰ï¼šä¸çœŸå® DOM ç»“æ„ä¸€æ ·çš„ï¼Œç”±èŠ‚ç‚¹ç»„æˆçš„æ ‘å½¢ç»“æ„</li><li>è™šæ‹ŸèŠ‚ç‚¹ï¼ˆvirtual nodeï¼Œvnodeï¼‰ï¼šè™šæ‹Ÿ DOM æ ‘çš„èŠ‚ç‚¹ï¼Œç”±ä¸€ä¸ª JavaScript å¯¹è±¡è¡¨ç¤º</li><li>æŒ‚è½½ï¼ˆmountï¼‰ï¼šæ¸²æŸ“å™¨æŠŠè™šæ‹Ÿ DOM èŠ‚ç‚¹æ¸²æŸ“ä¸ºçœŸå® DOM èŠ‚ç‚¹çš„è¿‡ç¨‹</li><li>æŒ‚è½½ç‚¹ï¼ˆcontainerï¼‰ï¼šæŒ‡å®šæ¸²æŸ“å™¨æŒ‚è½½çš„å…·ä½“ä½ç½®ï¼Œæ¸²æŸ“å™¨ä¼šæŠŠè¯¥ DOM å…ƒç´ ä½œä¸ºå®¹å™¨å…ƒç´ </li></ul></details><p>æˆ‘ä»¬é€šè¿‡ <code>createRenderer</code> å‡½æ•°åˆ›å»ºä¸€ä¸ªæ¸²æŸ“å™¨ï¼Œæ²¡æœ‰ç›´æ¥å®šä¹‰ render å‡½æ•°çš„åŸå› æ˜¯ï¼š âœ… æ¸²æŸ“å™¨ä¸åŒäºæ¸²æŸ“ï¼Œå®ƒçš„æ¦‚å¿µæ›´åŠ å®½æ³›ï¼Œå®ƒä¸ä»…å¯ä»¥ç”¨æ¥æ¸²æŸ“<code>mount</code>ï¼Œä¹Ÿå¯ä»¥æ¿€æ´»å·²æœ‰å…ƒç´ <code>hydrate</code>...</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">createRenderer</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token comment">// æ‰“è¡¥ä¸ï¼šæ ¹æ® n1 æ—§èŠ‚ç‚¹å­˜åœ¨ä¸å¦ï¼Œå†…éƒ¨æŒ‚è½½æˆ–æ›´æ–°</span>\n    <span class="token keyword">function</span> <span class="token function">patch</span><span class="token punctuation">(</span><span class="token parameter">n1<span class="token punctuation">,</span> n2<span class="token punctuation">,</span> container</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">/*...*/</span> <span class="token punctuation">}</span>\n\n    <span class="token keyword">function</span> <span class="token function">render</span><span class="token punctuation">(</span><span class="token parameter">vnode<span class="token punctuation">,</span> container</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token keyword">if</span> <span class="token punctuation">(</span>vnode<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n            <span class="token comment">// æ–° vnode å­˜åœ¨ï¼Œå°†å…¶ä¸æ—§ vnode ä¸€èµ·ä¼ é€’ç»™ patch å‡½æ•°è¿›è¡Œæ‰“è¡¥ä¸</span>\n            <span class="token function">patch</span><span class="token punctuation">(</span>container<span class="token punctuation">.</span>_vnode<span class="token punctuation">,</span> vnode<span class="token punctuation">,</span> container<span class="token punctuation">)</span>\n        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>\n            <span class="token keyword">if</span> <span class="token punctuation">(</span>container<span class="token punctuation">.</span>_vnode<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n                <span class="token comment">// æ—§ vnode å­˜åœ¨ï¼Œä¸”æ–° vnode ä¸å­˜åœ¨ï¼Œè¯´æ˜æ˜¯å¸è½½(unmount)æ“ä½œ</span>\n                container<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> <span class="token string">&#39;&#39;</span>\n            <span class="token punctuation">}</span>\n        <span class="token punctuation">}</span>\n        <span class="token comment">// æŠŠ vnode å­˜å‚¨åˆ° container._vnode ä¸‹ï¼Œå³åç»­æ¸²æŸ“ä¸­çš„æ—§ vnode</span>\n        container<span class="token punctuation">.</span>_vnode <span class="token operator">=</span> vnode\n    <span class="token punctuation">}</span>\n\n    <span class="token keyword">return</span> <span class="token punctuation">{</span>\n        render\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">const</span> renderer <span class="token operator">=</span> <span class="token function">createRenderer</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n\n<span class="token comment">// é¦–æ¬¡æ¸²æŸ“ï¼šæŒ‚è½½ patch(undefined, vnode, container)</span>\nrenderer<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span>vnode1<span class="token punctuation">,</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&#39;#app&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>\n<span class="token comment">// ç¬¬äºŒæ¬¡æ¸²æŸ“ï¼šæ›´æ–° patch(_vnode, vnode, container)</span>\nrenderer<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span>vnode2<span class="token punctuation">,</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&#39;#app&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>\n<span class="token comment">// ç¬¬ä¸‰æ¬¡æ¸²æŸ“ï¼šå¸è½½ patch(_vnode, null, container)</span>\nrenderer<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&#39;#app&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br></div></div><p>ğŸ”¥ é¦–æ¬¡æ¸²æŸ“æ—¶å·²ç»æŠŠ oldNode æ¸²æŸ“åˆ° container å†…äº†ï¼Œæ‰€ä»¥å½“å†æ¬¡è°ƒç”¨ renderer. Render å‡½æ•°å¹¶å°è¯•æ¸²æŸ“ newNode æ—¶ï¼Œå°±ä¸èƒ½ç®€å•åœ°æ‰§è¡ŒæŒ‚è½½åŠ¨ä½œäº†ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ¸²æŸ“å™¨ä¼šä½¿ç”¨ newNode ä¸ä¸Šä¸€æ¬¡æ¸²æŸ“çš„ oldNode æ¯”è¾ƒï¼Œè¯•å›¾æ‰¾åˆ°å¹¶æ›´æ–°å˜æ›´ç‚¹ã€‚è¿™ä¸ªè¿‡ç¨‹å«åšâ€œæ‰“è¡¥ä¸â€ï¼ˆæˆ–æ›´æ–°ï¼‰ï¼Œè‹±æ–‡é€šå¸¸ç”¨ patch æ¥è¡¨è¾¾ã€‚</p><p>ğŸ“ æŒ‚è½½åŠ¨ä½œæœ¬èº«ä¹Ÿå¯ä»¥çœ‹ä½œä¸€ç›´ç‰¹æ®Šçš„æ‰“è¡¥ä¸ï¼Œå®ƒçš„ç‰¹æ®Šä¹‹å¤„åœ¨äºæ—§çš„ VNode ä¸å­˜åœ¨ã€‚</p><blockquote><p>patch å‡½æ•°æ˜¯æ•´ä¸ªæ¸²æŸ“å™¨çš„æ ¸å¿ƒå…¥å£ï¼Œå®ƒæ‰¿è½½äº†æœ€é‡è¦çš„æ¸²æŸ“é€»è¾‘ï¼›</p><p>patch å‡½æ•°ä¸ä»…å¯ä»¥ç”¨æ¥æŒ‚è½½ï¼Œä¹Ÿå¯ä»¥ç”¨æ¥æ›´æ–°ï¼›</p><p>render å‡½æ•°æ˜¯å…¥å£ï¼Œå†…éƒ¨åˆ¤æ–­æ˜¯ mountã€patch è¿˜æ˜¯ unmountã€‚</p></blockquote><h2 id="è‡ªå®šä¹‰æ¸²æŸ“å™¨" tabindex="-1"><a class="header-anchor" href="#è‡ªå®šä¹‰æ¸²æŸ“å™¨" aria-hidden="true">#</a> è‡ªå®šä¹‰æ¸²æŸ“å™¨</h2><p>ğŸ”¥ æ¸²æŸ“å™¨è¦å®ç°è·¨å¹³å°èƒ½åŠ›ï¼Œéœ€è¦<strong>æŠ½è±¡</strong>å‡º<strong>ä¸å¯å¤ç”¨éƒ¨åˆ†</strong>ã€‚</p><p>ğŸ“ å¯¹äºæµè§ˆå™¨ä½œä¸ºæ¸²æŸ“çš„ç›®æ ‡å¹³å°æ—¶ï¼Œå°†æµè§ˆå™¨çš„ç‰¹å®š API æŠ½ç¦»ï¼Œè¿™æ ·å°±å¯ä»¥ä½¿å¾—æ¸²æŸ“å™¨çš„æ ¸å¿ƒä¸ä¾èµ–äºæµè§ˆå™¨ã€‚åœ¨æ­¤åŸºç¡€ä¸Šï¼Œæˆ‘ä»¬å†ä¸ºé‚£äº›è¢«æŠ½ç¦»çš„ API æä¾›å¯é…ç½®çš„æ¥å£ï¼Œå³å¯å®ç°æ¸²æŸ“å™¨çš„è·¨å¹³å°èƒ½åŠ›ã€‚</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// æŠŠæ“ä½œ DOM çš„ API å°è£…ä¸ºä¸€ä¸ªå¯¹è±¡ï¼Œå½“åšå‚æ•°ä¼ é€’</span>\n<span class="token keyword">function</span> <span class="token function">createRenderer</span><span class="token punctuation">(</span><span class="token parameter">options</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token comment">// æ¸²æŸ“å™¨æ ¹æ®é…ç½®å¾—åˆ°æ“ä½œ DOM çš„ APIï¼Œå®ç°é€šç”¨çš„æ¸²æŸ“å™¨</span>\n    <span class="token keyword">const</span> <span class="token punctuation">{</span>\n        createElement<span class="token punctuation">,</span>\n        insert<span class="token punctuation">,</span>\n        setElementText\n    <span class="token punctuation">}</span> <span class="token operator">=</span> options\n\n    <span class="token keyword">function</span> <span class="token function">mountElement</span><span class="token punctuation">(</span><span class="token parameter">vnode<span class="token punctuation">,</span> container</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token keyword">const</span> el <span class="token operator">=</span> <span class="token function">createElement</span><span class="token punctuation">(</span>vnode<span class="token punctuation">.</span>type<span class="token punctuation">)</span>\n        <span class="token comment">// é€šè¿‡ä¼ å…¥çš„ API æ“ä½œ DOM</span>\n        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> vnode<span class="token punctuation">.</span>children <span class="token operator">===</span> <span class="token string">&#39;string&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n            <span class="token function">setElementText</span><span class="token punctuation">(</span>el<span class="token punctuation">,</span> vnode<span class="token punctuation">.</span>children<span class="token punctuation">)</span>\n        <span class="token punctuation">}</span>\n        <span class="token function">insert</span><span class="token punctuation">(</span>el<span class="token punctuation">,</span> container<span class="token punctuation">)</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token keyword">function</span> <span class="token function">patch</span><span class="token punctuation">(</span><span class="token parameter">n1<span class="token punctuation">,</span> n2<span class="token punctuation">,</span> container</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>n1<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n            <span class="token comment">// åˆå§‹æŒ‚è½½</span>\n            <span class="token function">mountElement</span><span class="token punctuation">(</span>n2<span class="token punctuation">,</span> container<span class="token punctuation">)</span>\n        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>\n            <span class="token comment">// æ›´æ–°</span>\n        <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token keyword">function</span> <span class="token function">render</span><span class="token punctuation">(</span><span class="token parameter">vnode<span class="token punctuation">,</span> container</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token keyword">if</span> <span class="token punctuation">(</span>vnode<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n            <span class="token function">patch</span><span class="token punctuation">(</span>container<span class="token punctuation">.</span>_vnode<span class="token punctuation">,</span> vnode<span class="token punctuation">,</span> container<span class="token punctuation">)</span>\n        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>\n            <span class="token keyword">if</span> <span class="token punctuation">(</span>container<span class="token punctuation">.</span>_vnode<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n                container<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> <span class="token string">&#39;&#39;</span>\n            <span class="token punctuation">}</span>\n        <span class="token punctuation">}</span>\n        container<span class="token punctuation">.</span>_vnode <span class="token operator">=</span> vnode\n    <span class="token punctuation">}</span>\n\n    <span class="token keyword">return</span> <span class="token punctuation">{</span>\n        render\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br></div></div><h3 id="æµè§ˆå™¨æ¸²æŸ“å™¨" tabindex="-1"><a class="header-anchor" href="#æµè§ˆå™¨æ¸²æŸ“å™¨" aria-hidden="true">#</a> æµè§ˆå™¨æ¸²æŸ“å™¨</h3><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> renderer <span class="token operator">=</span> <span class="token function">createRenderer</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n    <span class="token function">createElement</span><span class="token punctuation">(</span><span class="token parameter">tag</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token keyword">return</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span>tag<span class="token punctuation">)</span>\n    <span class="token punctuation">}</span><span class="token punctuation">,</span>\n    <span class="token function">setElementText</span><span class="token punctuation">(</span><span class="token parameter">el<span class="token punctuation">,</span> text</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        el<span class="token punctuation">.</span>textContent <span class="token operator">=</span> text\n    <span class="token punctuation">}</span><span class="token punctuation">,</span>\n    <span class="token function">insert</span><span class="token punctuation">(</span><span class="token parameter">el<span class="token punctuation">,</span> parent<span class="token punctuation">,</span> anchor <span class="token operator">=</span> <span class="token keyword">null</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        parent<span class="token punctuation">.</span><span class="token function">insertBefore</span><span class="token punctuation">(</span>el<span class="token punctuation">,</span> anchor<span class="token punctuation">)</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span>\n\n<span class="token keyword">const</span> vnode <span class="token operator">=</span> <span class="token punctuation">{</span>\n    type<span class="token operator">:</span> <span class="token string">&#39;h1&#39;</span><span class="token punctuation">,</span>\n    children<span class="token operator">:</span> <span class="token string">&#39;hello&#39;</span>\n<span class="token punctuation">}</span>\n\nrenderer<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span>vnode<span class="token punctuation">,</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&#39;#app&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><h3 id="è‡ªå®šä¹‰æ¸²æŸ“å™¨-1" tabindex="-1"><a class="header-anchor" href="#è‡ªå®šä¹‰æ¸²æŸ“å™¨-1" aria-hidden="true">#</a> è‡ªå®šä¹‰æ¸²æŸ“å™¨</h3><p>é€šè¿‡å·²æœ‰çš„é€šç”¨æ¸²æŸ“å™¨ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥åˆ›å»ºä¸€ä¸ªç”¨æ¥æ‰“å°æ¸²æŸ“å™¨æ“ä½œæµç¨‹çš„è‡ªå®šä¹‰æ¸²æŸ“å™¨ï¼š</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> renderer2 <span class="token operator">=</span> <span class="token function">createRenderer</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n    <span class="token function">createElement</span><span class="token punctuation">(</span><span class="token parameter">tag</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">åˆ›å»ºå…ƒç´  </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>tag<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>\n        <span class="token keyword">return</span> <span class="token punctuation">{</span> tag <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span><span class="token punctuation">,</span>\n    <span class="token function">setElementText</span><span class="token punctuation">(</span><span class="token parameter">el<span class="token punctuation">,</span> text</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">è®¾ç½® </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>el<span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> çš„æ–‡æœ¬å†…å®¹ï¼š</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>text<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>\n        el<span class="token punctuation">.</span>text <span class="token operator">=</span> text\n    <span class="token punctuation">}</span><span class="token punctuation">,</span>\n    <span class="token function">insert</span><span class="token punctuation">(</span><span class="token parameter">el<span class="token punctuation">,</span> parent<span class="token punctuation">,</span> anchor <span class="token operator">=</span> <span class="token keyword">null</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">å°† </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>el<span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> æ·»åŠ åˆ° </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>parent<span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> ä¸‹</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>\n        parent<span class="token punctuation">.</span>children <span class="token operator">=</span> el\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span>\n\n<span class="token keyword">const</span> container <span class="token operator">=</span> <span class="token punctuation">{</span> type<span class="token operator">:</span> <span class="token string">&#39;root&#39;</span> <span class="token punctuation">}</span>\nrenderer2<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span>vnode<span class="token punctuation">,</span> container<span class="token punctuation">)</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><h2 id="æ€»ç»“" tabindex="-1"><a class="header-anchor" href="#æ€»ç»“" aria-hidden="true">#</a> æ€»ç»“</h2><p>âœ… æ¸²æŸ“å™¨ä¸å“åº”ç³»ç»Ÿä¹‹é—´çš„å…³ç³»ï¼šåˆ©ç”¨å“åº”ç³»ç»Ÿçš„èƒ½åŠ›ï¼Œæˆ‘ä»¬å¯ä»¥åšåˆ°ï¼Œå½“å“åº”å¼æ•°æ®å‘ç”Ÿå˜åŒ–æ—¶è‡ªåŠ¨å®Œæˆé¡µé¢æ›´æ–°ï¼ˆæˆ–é‡æ–°æ¸²æŸ“ï¼‰ã€‚</p><p>âœ… æ¸²æŸ“å™¨ä¼šæ‰§è¡ŒæŒ‚è½½å’Œæ‰“è¡¥ä¸çš„æ“ä½œï¼Œå¯¹äºæ–°çš„å…ƒç´ ï¼Œæ¸²æŸ“å™¨ä¼šå°†å®ƒæŒ‚è½½åˆ°å®¹å™¨å†…ï¼›å¯¹äºæ–°æ—§ vnode éƒ½å­˜åœ¨çš„æƒ…å†µï¼Œæ¸²æŸ“å™¨åˆ™ä¼šæ‰§è¡Œæ‰“è¡¥ä¸æ“ä½œï¼Œå³å¯¹æ¯”æ–°æ—§ vnodeï¼Œåªæ›´æ–°å˜åŒ–çš„å†…å®¹ã€‚</p><p>âœ… é€šç”¨æ¸²æŸ“å™¨å°†ç”¨æ¥åˆ›å»ºã€ä¿®æ”¹å’Œåˆ é™¤å…ƒç´ çš„æ“ä½œ<strong>æŠ½è±¡</strong>æˆå¯é…ç½®çš„å¯¹è±¡ã€‚ç”¨æˆ·å¯ä»¥åœ¨åˆ›å»ºæ¸²æŸ“å™¨çš„æ—¶å€™æŒ‡å®šè‡ªå®šä¹‰çš„é…ç½®å¯¹è±¡ï¼Œä»è€Œå®ç°è‡ªå®šä¹‰çš„è¡Œä¸ºã€‚</p>',25),t={render:function(n,s){return p}}}}]);