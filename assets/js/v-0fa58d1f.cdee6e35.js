"use strict";(self.webpackChunkblog=self.webpackChunkblog||[]).push([[7193],{5675:(n,s,a)=>{a.r(s),a.d(s,{data:()=>t});const t={key:"v-0fa58d1f",path:"/VueJs3/section3/chapter8.html",title:"æŒ‚è½½ä¸æ›´æ–°",lang:"zh-CN",frontmatter:{},excerpt:"",headers:[{level:2,title:"æŒ‚è½½å­èŠ‚ç‚¹å’Œå…ƒç´ çš„å±æ€§",slug:"æŒ‚è½½å­èŠ‚ç‚¹å’Œå…ƒç´ çš„å±æ€§",children:[]},{level:2,title:"HTML Attributes ä¸ DOM Properties",slug:"html-attributes-ä¸-dom-properties",children:[{level:3,title:"ä¸¤è€…å…³ç³»",slug:"ä¸¤è€…å…³ç³»",children:[]},{level:3,title:"é»˜è®¤å€¼æ ¡éªŒ",slug:"é»˜è®¤å€¼æ ¡éªŒ",children:[]}]},{level:2,title:"æ­£ç¡®åœ°è®¾ç½®å…ƒç´ å±æ€§",slug:"æ­£ç¡®åœ°è®¾ç½®å…ƒç´ å±æ€§",children:[{level:3,title:"æµè§ˆå™¨è§£æ",slug:"æµè§ˆå™¨è§£æ",children:[]},{level:3,title:"Vue.js çš„è§£æ",slug:"vue-js-çš„è§£æ",children:[]},{level:3,title:"é€šç”¨çš„å±æ€§è®¾ç½®",slug:"é€šç”¨çš„å±æ€§è®¾ç½®",children:[]}]},{level:2,title:"class çš„å¤„ç†",slug:"class-çš„å¤„ç†",children:[{level:3,title:"class å€¼å¤„ç†",slug:"class-å€¼å¤„ç†",children:[]},{level:3,title:"å…ƒç´ è®¾ç½® class",slug:"å…ƒç´ è®¾ç½®-class",children:[]}]},{level:2,title:"å¸è½½æ“ä½œ",slug:"å¸è½½æ“ä½œ",children:[]},{level:2,title:"åŒºåˆ† vode çš„ç±»å‹",slug:"åŒºåˆ†-vode-çš„ç±»å‹",children:[]},{level:2,title:"äº‹ä»¶çš„å¤„ç†",slug:"äº‹ä»¶çš„å¤„ç†",children:[]},{level:2,title:"æ—¶é—´å†’æ³¡ä¸æ›´æ–°æ—¶æœº",slug:"æ—¶é—´å†’æ³¡ä¸æ›´æ–°æ—¶æœº",children:[{level:3,title:"é—®é¢˜åˆ†æ",slug:"é—®é¢˜åˆ†æ",children:[]},{level:3,title:"å¤„ç†",slug:"å¤„ç†",children:[]}]},{level:2,title:"æ›´æ–°å­èŠ‚ç‚¹",slug:"æ›´æ–°å­èŠ‚ç‚¹",children:[]},{level:2,title:"æ–‡æœ¬èŠ‚ç‚¹å’Œæ³¨é‡ŠèŠ‚ç‚¹",slug:"æ–‡æœ¬èŠ‚ç‚¹å’Œæ³¨é‡ŠèŠ‚ç‚¹",children:[]},{level:2,title:"Fragment",slug:"fragment",children:[]}],filePathRelative:"VueJs3/section3/chapter8.md",git:{updatedTime:1656479933e3,contributors:[{name:"Jerry Chen",email:"caffreygo@163.com",commits:5},{name:"Jinrui Chen",email:"jinrui@kooboo.cn",commits:2}]}}},3021:(n,s,a)=>{a.r(s),a.d(s,{default:()=>V});var t=a(6252);const p=(0,t.uE)('<h1 id="æŒ‚è½½ä¸æ›´æ–°" tabindex="-1"><a class="header-anchor" href="#æŒ‚è½½ä¸æ›´æ–°" aria-hidden="true">#</a> æŒ‚è½½ä¸æ›´æ–°</h1><p><img src="https://raw.githubusercontent.com/caffreygo/static/main/blog/Vuejs3/patch.png" alt=""></p><h2 id="æŒ‚è½½å­èŠ‚ç‚¹å’Œå…ƒç´ çš„å±æ€§" tabindex="-1"><a class="header-anchor" href="#æŒ‚è½½å­èŠ‚ç‚¹å’Œå…ƒç´ çš„å±æ€§" aria-hidden="true">#</a> æŒ‚è½½å­èŠ‚ç‚¹å’Œå…ƒç´ çš„å±æ€§</h2><ul><li><p>å­èŠ‚ç‚¹ï¼švnode çš„å­èŠ‚ç‚¹æœ‰å¯èƒ½æ˜¯æ–‡æœ¬å­—ç¬¦ä¸²ï¼Œå½“ç„¶ä¹Ÿä¼šæ˜¯æ ‡ç­¾ï¼Œå¹¶ä¸”å­èŠ‚ç‚¹å¯ä»¥æ˜¯å¾ˆå¤šä¸ªã€‚ä¸ºäº†æè¿°å…ƒç´ çš„å­èŠ‚ç‚¹ï¼Œå¯ä»¥ä½¿ç”¨<strong>æ•°ç»„</strong>æ¥è¡¨ç¤º</p></li><li><p>å±æ€§ï¼šä¸ºäº†æè¿°ä¸€ä¸ªå…ƒç´ çš„å±æ€§ï¼Œæˆ‘ä»¬å¯ä»¥ä¸ºè™šæ‹Ÿ DOM æ·»åŠ ä¸€ä¸ª vnode.props å­—æ®µ</p></li></ul><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> vnode <span class="token operator">=</span> <span class="token punctuation">{</span>\n    type<span class="token operator">:</span> <span class="token string">&#39;div&#39;</span><span class="token punctuation">,</span>\n    props<span class="token operator">:</span> <span class="token punctuation">{</span>\n        id<span class="token operator">:</span> <span class="token string">&#39;foo&#39;</span>\n    <span class="token punctuation">}</span><span class="token punctuation">,</span>\n    children<span class="token operator">:</span> <span class="token punctuation">[</span>\n        <span class="token punctuation">{</span>\n            type<span class="token operator">:</span> <span class="token string">&#39;p&#39;</span><span class="token punctuation">,</span>\n            children<span class="token operator">:</span> <span class="token string">&#39;hello&#39;</span>\n        <span class="token punctuation">}</span>\n    <span class="token punctuation">]</span>\n<span class="token punctuation">}</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>ä¸ºäº†æ¸²æŸ“å­èŠ‚ç‚¹å’Œå±æ€§ï¼ŒåŒæ—¶ä¹Ÿéœ€è¦ä¿®æ”¹å¯¹åº”çš„ mountElement å‡½æ•°ï¼š</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">mountElement</span><span class="token punctuation">(</span><span class="token parameter">vnode<span class="token punctuation">,</span> container</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">const</span> el <span class="token operator">=</span> <span class="token function">createElement</span><span class="token punctuation">(</span>vnode<span class="token punctuation">.</span>type<span class="token punctuation">)</span>\n    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> vnode<span class="token punctuation">.</span>children <span class="token operator">===</span> <span class="token string">&#39;string&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token function">setElementText</span><span class="token punctuation">(</span>el<span class="token punctuation">,</span> vnode<span class="token punctuation">.</span>children<span class="token punctuation">)</span>\n    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>Array<span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span>vnode<span class="token punctuation">.</span>children<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token comment">// å¦‚æœ children æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œåˆ™éå†æ¯ä¸ªå­èŠ‚ç‚¹ï¼Œå¹¶è°ƒç”¨ patch å‡½æ•°æŒ‚è½½å®ƒä»¬</span>\n        vnode<span class="token punctuation">.</span>children<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">child</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>\n            <span class="token function">patch</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> child<span class="token punctuation">,</span> el<span class="token punctuation">)</span>\n        <span class="token punctuation">}</span><span class="token punctuation">)</span>\n    <span class="token punctuation">}</span>\n    <span class="token comment">// å¦‚æœ vnode.props å­˜åœ¨æ‰å¤„ç†å®ƒ</span>\n    <span class="token keyword">if</span> <span class="token punctuation">(</span>vnode<span class="token punctuation">.</span>props<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token comment">// éå† vnode.props</span>\n        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> key <span class="token keyword">in</span> vnode<span class="token punctuation">.</span>props<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n            <span class="token comment">// æˆ– el[key] = vnode.props[key]</span>\n            el<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> vnode<span class="token punctuation">.</span>props<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">)</span>\n        <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token function">insert</span><span class="token punctuation">(</span>el<span class="token punctuation">,</span> container<span class="token punctuation">)</span>\n<span class="token punctuation">}</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><p>åœ¨å¤„ç†å±æ€§æ—¶ï¼Œä¸ºå…ƒç´ è®¾ç½®å±æ€§æ— è®ºæ˜¯ä½¿ç”¨ setAttribute å‡½æ•°ï¼Œè¿˜æ˜¯ç›´æ¥æ“ä½œ DOM å¯¹è±¡ï¼Œéƒ½å­˜åœ¨ç¼ºé™·ã€‚</p><h2 id="html-attributes-ä¸-dom-properties" tabindex="-1"><a class="header-anchor" href="#html-attributes-ä¸-dom-properties" aria-hidden="true">#</a> HTML Attributes ä¸ DOM Properties</h2><p>ä»æœ€åŸºæœ¬çš„ HTML ä¸ºä¾‹ï¼š</p><div class="language-html ext-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>my-input<span class="token punctuation">&quot;</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>foo<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>HTML Attributes æŒ‡çš„å°±æ˜¯å®šä¹‰åœ¨ HTML æ ‡ç­¾ä¸Šçš„å±æ€§ï¼Œè¿™é‡ŒæŒ‡çš„å°±æ˜¯ id=â€œmy-inputâ€ã€type=â€œtextâ€ å’Œ value=â€œfooâ€ã€‚å½“æµè§ˆå™¨è§£æè¿™æ®µ HTML ä»£ç ä¹‹åï¼Œå¯ä»¥å¾—åˆ°è¯¥ DOM å¯¹è±¡ï¼š</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> el <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&quot;#my-input&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>è¿™ä¸ª DOM å¯¹è±¡ä¼šåŒ…å«å¾ˆå¤š<strong>å±æ€§</strong>ï¼ˆpropertiesï¼‰ï¼Œè¿™äº›å±æ€§å°±æ˜¯æ‰€è°“çš„ DOM Propertiesã€‚</p><details class="custom-container details"><summary>HTML Attributes ä¸ DOM Properties çš„å…³è”</summary><ul><li><p>å¾ˆå¤š HTML Attributes åœ¨ DOM å¯¹è±¡ä¸Šæœ‰ä¸ä¹‹åŒåçš„ DOM Propertiesï¼Œå¦‚ id=â€œmy-inputâ€ ä¸ el.idï¼Œtype=&quot;text&quot; ä¸ el.type...</p></li><li><p>ä½†ä¸¤è€…åå­—å¹¶ä¸æ€»æ˜¯ä¸€æ¨¡ä¸€æ ·ï¼šclass=&quot;foo&quot; ä¸ el.className</p></li><li><p>å¹¶ä¸æ˜¯æ‰€æœ‰çš„ HTML Attributes éƒ½æœ‰ä¸ä¹‹å¯¹åº”çš„ DOM Propertiesï¼šaria-* ç±»çš„ HTML Attributes</p></li><li><p>ä¹Ÿå¹¶ä¸æ˜¯æ‰€æœ‰çš„ DOM Properties éƒ½æœ‰ä¸ä¹‹å¯¹åº”çš„ HTML Attributesï¼šel.textContent å¯ä»¥è®¾ç½®æ–‡æœ¬å†…å®¹ï¼Œä½†æ²¡æœ‰å¯¹åº”çš„ HTML Attributes</p></li><li><p>ç›´æ¥æ˜ å°„ï¼šHTML Attributes ä¸ DOM Properties å…·æœ‰ç›¸åŒåç§°çš„å±æ€§ï¼Œä¾‹å¦‚ id=&quot;foo&quot; ä¸ el.id</p></li></ul></details><h3 id="ä¸¤è€…å…³ç³»" tabindex="-1"><a class="header-anchor" href="#ä¸¤è€…å…³ç³»" aria-hidden="true">#</a> ä¸¤è€…å…³ç³»</h3><p>ğŸš€ <strong>HTML Attributes çš„ä½œç”¨æ˜¯è®¾ç½®ä¸ä¹‹å¯¹åº”çš„ DOM Properties çš„åˆå§‹å€¼</strong>ã€‚</p><p>ä¸€æ—¦å€¼æ”¹å˜ï¼Œé‚£ä¹ˆ DOM Properties å§‹ç»ˆå­˜å‚¨ç€å½“å‰å€¼ï¼Œè€Œé€šè¿‡ getAttribute å‡½æ•°å¾—åˆ°çš„ä»ç„¶æ˜¯åˆå§‹å€¼ã€‚</p><div class="language-html ext-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>foo<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>foo<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>\n\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">\n\t<span class="token keyword">const</span> el <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&quot;#foo&quot;</span><span class="token punctuation">)</span>\n  <span class="token comment">// ç”¨æˆ·åœ¨è¾“å…¥æ¡†ä¿®æ”¹å†…å®¹ä¸º bar å</span>\n  <span class="token comment">// æ–‡æœ¬æ¡†å†…å®¹çš„ä¿®æ”¹å¹¶ä¸ä¼šå½±å“ el.getAttribute(&#39;value&#39;) çš„è¿”å›å€¼ã€‚</span>\n  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>el<span class="token punctuation">.</span>value<span class="token punctuation">)</span>  <span class="token comment">// &#39;bar&#39;</span>\n  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>el<span class="token punctuation">.</span><span class="token function">getAttribute</span><span class="token punctuation">(</span><span class="token string">&#39;value&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment">// &#39;foo&#39;</span>\n  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>el<span class="token punctuation">.</span>defaultValue<span class="token punctuation">)</span>  <span class="token comment">// &#39;foo&#39;</span>\n</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>\n</code></pre><div class="highlight-lines"><br><br><br><br><br><br><br><div class="highlight-line">Â </div><br><br></div><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>è¿™é‡Œä¹Ÿè¯´æ˜ï¼Œä¸€ä¸ª HTML Attributes å¯èƒ½å…³è”å¤šä¸ª DOM Propertiesã€‚</p><h3 id="é»˜è®¤å€¼æ ¡éªŒ" tabindex="-1"><a class="header-anchor" href="#é»˜è®¤å€¼æ ¡éªŒ" aria-hidden="true">#</a> é»˜è®¤å€¼æ ¡éªŒ</h3><p>è™½ç„¶æˆ‘ä»¬å¯ä»¥è®¤ä¸º HTML Attributes æ˜¯ç”¨æ¥è®¾ç½®ä¸ä¹‹å¯¹åº”çš„ DOM Properties çš„åˆå§‹å€¼çš„ï¼Œä½†æœ‰äº›å€¼æ˜¯å—é™åˆ¶çš„ï¼Œå°±å¥½åƒæµè§ˆå™¨å†…éƒ¨åšäº†é»˜è®¤å€¼æ ¡éªŒã€‚å¦‚æœä½ é€šè¿‡ HTML Attributes æä¾›çš„é»˜è®¤å€¼ä¸åˆæ³•ï¼Œé‚£ä¹ˆæµè§ˆå™¨ä¼šä½¿ç”¨å†…å»ºçš„åˆæ³•å€¼ä½œä¸ºå¯¹åº” DOM Properties çš„é»˜è®¤å€¼ï¼š</p><div class="language-html ext-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>my-input<span class="token punctuation">&quot;</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>foo<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>\n\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">\n  <span class="token keyword">const</span> el <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&quot;#my-input&quot;</span><span class="token punctuation">)</span>\n  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>el<span class="token punctuation">.</span>type<span class="token punctuation">)</span>  <span class="token comment">// &#39;text&#39;</span>\n</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>\n</code></pre><div class="highlight-lines"><br><br><br><br><div class="highlight-line">Â </div><br></div><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h2 id="æ­£ç¡®åœ°è®¾ç½®å…ƒç´ å±æ€§" tabindex="-1"><a class="header-anchor" href="#æ­£ç¡®åœ°è®¾ç½®å…ƒç´ å±æ€§" aria-hidden="true">#</a> æ­£ç¡®åœ°è®¾ç½®å…ƒç´ å±æ€§</h2><h3 id="æµè§ˆå™¨è§£æ" tabindex="-1"><a class="header-anchor" href="#æµè§ˆå™¨è§£æ" aria-hidden="true">#</a> æµè§ˆå™¨è§£æ</h3><p>æµè§ˆå™¨æœ¬èº«ä¼šè§£æ HTML ä»£ç ï¼Œè‡ªåŠ¨åˆ†æ HTML Attributes å¹¶è®¾ç½®åˆé€‚çš„ DOM Propertiesã€‚ä½†æ˜¯ Vue.js çš„å•æ–‡ä»¶ç»„ä»¶ä¸­çš„æ¨¡æ¿å°±éœ€è¦è‡ªè¡Œç¼–è¯‘ã€‚</p><p>ä»¥ç¦ç”¨çš„æŒ‰é’®ä¸ºä¾‹ï¼š</p><div class="language-html ext-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">disabled</span><span class="token punctuation">&gt;</span></span>Button<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>å¯¹äºæµè§ˆå™¨æ¥è¯´ï¼Œå½“è§£æåˆ°è¿™æ ·ä¸€æ®µ HTMLï¼Œå®ƒä¼šå‘ç°è¿™ä¸ªæŒ‰é’®å­˜åœ¨ disabled çš„ HTML Attributesï¼Œäºæ˜¯æµè§ˆå™¨ä¼šæŠŠè¿™ä¸ªæŒ‰é’®è®¾ç½®ä¸ºç¦ç”¨çŠ¶æ€ï¼Œå¹¶æŠŠå®ƒçš„ el.disabled è¿™ä¸ª DOM Properties çš„å€¼è®¾ç½®ä¸º trueã€‚</p><h3 id="vue-js-çš„è§£æ" tabindex="-1"><a class="header-anchor" href="#vue-js-çš„è§£æ" aria-hidden="true">#</a> Vue.js çš„è§£æ</h3><p>ç›¸åŒçš„æ¨¡æ¿ï¼Œå®ƒä¼šå…ˆè¢«ç¼–è¯‘æˆ vnodeï¼Œå®ƒç­‰ä»·äºï¼š</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> button <span class="token operator">=</span> <span class="token punctuation">{</span>\n\ttype<span class="token operator">:</span> <span class="token string">&#39;button&#39;</span><span class="token punctuation">,</span>\n\tprops<span class="token operator">:</span> <span class="token punctuation">{</span>\n\t\tdisabled<span class="token operator">:</span> <span class="token string">&#39;&#39;</span>\n\t<span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>è¿™é‡Œ disabled çš„å€¼ä¸ºç©ºå­—ç¬¦ä¸²ï¼Œå¦‚æœåœ¨æ¸²æŸ“å™¨ä¸­è°ƒç”¨ setAttribute å‡½æ•°è®¾ç½®å±æ€§ï¼Œç›¸å½“äºï¼š</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code>el<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">&#39;disabled&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;&#39;</span><span class="token punctuation">)</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>è¿™ä¹ˆåšæ˜¯æ²¡æœ‰é—®é¢˜çš„ï¼Œæµè§ˆå™¨å°†ä¼šå°†æŒ‰é’®ç¦ç”¨ã€‚ä½†æ˜¯å¯¹äº Vue.js æ¥è¯´ï¼Œè¦è€ƒè™‘å¦‚ä¸‹æ¨¡æ¿ï¼š</p><div class="language-html ext-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">:disabled</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>false<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>Button<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>å®ƒå¯¹åº”çš„ vnode ä¸ºï¼š</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> button <span class="token operator">=</span> <span class="token punctuation">{</span>\n\ttype<span class="token operator">:</span> <span class="token string">&#39;button&#39;</span><span class="token punctuation">,</span>\n\tprops<span class="token operator">:</span> <span class="token punctuation">{</span>\n\t\tdisabled<span class="token operator">:</span> <span class="token boolean">false</span>\n\t<span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>è¿™é‡Œçš„æœ¬æ„æ˜¯â€œä¸ç¦ç”¨â€æŒ‰é’®ï¼Œä½†æ˜¯ç”±äº setAttribute å‡½æ•°è®¾ç½®çš„å€¼æ€»æ˜¯ä¼šè¢«å­—ç¬¦ä¸²åŒ–ï¼Œç­‰ä»·äº</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// el.setAttribute(&#39;disabled&#39;, false)</span>\nel<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">&#39;disabled&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;false&#39;</span><span class="token punctuation">)</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>ğŸ”¥ å¯¹äºæŒ‰é’®æ¥è¯´ï¼Œå®ƒçš„ el.disabled å±æ€§å€¼æ˜¯å¸ƒå°”ç±»å‹çš„ï¼Œå¹¶ä¸”å®ƒä¸å…³å¿ƒå…·ä½“çš„ HTML Attributes çš„å€¼æ˜¯ä»€ä¹ˆï¼Œåªè¦ disabled å±æ€§å­˜åœ¨ï¼ŒæŒ‰é’®å°±ä¼šè¢«ç¦ç”¨ã€‚æ‰€ä»¥æ¸²æŸ“å™¨ä¸èƒ½ç”¨ setAttribute å‡½æ•°å°† vnode.props å¯¹è±¡ä¸­çš„å±æ€§è®¾ç½®åˆ°å…ƒç´ ä¸Šã€‚</p><h3 id="é€šç”¨çš„å±æ€§è®¾ç½®" tabindex="-1"><a class="header-anchor" href="#é€šç”¨çš„å±æ€§è®¾ç½®" aria-hidden="true">#</a> é€šç”¨çš„å±æ€§è®¾ç½®</h3><p>ğŸš€ æˆ‘ä»¬å¯ä»¥ä¼˜å…ˆè®¾ç½® DOM Properties</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// âœ… &lt;button :disabled=&quot;true&quot;&gt;Button&lt;/button&gt;</span>\nel<span class="token punctuation">.</span>disabled <span class="token operator">=</span> <span class="token boolean">true</span>\n\n<span class="token comment">// âœ… &lt;button :disabled=&quot;false&quot;&gt;Button&lt;/button&gt;</span>\nel<span class="token punctuation">.</span>disabled <span class="token operator">=</span> <span class="token boolean">false</span>\n\n<span class="token comment">// ğŸ™ˆ &lt;button disabled&gt;Button&lt;/button&gt;</span>\nel<span class="token punctuation">.</span>disabled <span class="token operator">=</span> <span class="token string">&#39;&#39;</span>  \n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>ğŸš€ ä½†æ˜¯å¯¹äº HTML Properties æ˜¯å¸ƒå°”å€¼ï¼Œprop æ˜¯ç©ºå­—ç¬¦ä¸²éœ€è¦ç‰¹æ®Šå¤„ç†ï¼Œè¦æ‰‹åŠ¨å°†å€¼çŸ«æ­£ä¸ºtrueã€‚</p><hr><div class="language-html ext-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>form1<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">&gt;</span></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">form</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>form1<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>åœ¨è¿™æ®µä»£ç ä¸­ï¼Œæˆ‘ä»¬ä¸º input æ ‡ç­¾è®¾ç½®äº† form å±æ€§ï¼ˆHTML Propertiesï¼‰ï¼Œä½†æ˜¯è¿™ä¸ªå±æ€§ el.form æ˜¯åªè¯»çš„ï¼Œåªèƒ½ä½¿ç”¨ setAttribute å‡½æ•°è®¾ç½®ï¼Œå› æ­¤å¯¹äºè¿™äº›æƒ…å†µæˆ‘ä»¬ä¹Ÿéœ€è¦ç‰¹æ®Šå¤„ç†ï¼Œç±»ä¼¼çš„è¡¨å•å…ƒç´ éƒ½æ˜¯å¦‚æ­¤ã€‚</p><p>ğŸš€ å¤„ç†æ€è·¯ï¼šå¯ä»¥æå–ä¸€ä¸ª shouldSetAsProps å‡½æ•°åˆ¤æ–­å±æ€§æ˜¯å¦åº”è¯¥ä½œä¸º DOM Properties å¤„ç†ã€‚</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">shouldSetAsProps</span><span class="token punctuation">(</span><span class="token parameter">el<span class="token punctuation">,</span> key<span class="token punctuation">,</span> value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token comment">// ç‰¹æ®Šå¤„ç†</span>\n  <span class="token keyword">if</span> <span class="token punctuation">(</span>key <span class="token operator">===</span> <span class="token string">&#39;form&#39;</span> <span class="token operator">&amp;&amp;</span> el<span class="token punctuation">.</span>tagName <span class="token operator">===</span> <span class="token string">&#39;INPUT&#39;</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">false</span>\n  <span class="token comment">// å…œåº•</span>\n  <span class="token keyword">return</span> key <span class="token keyword">in</span> el\n<span class="token punctuation">}</span>\n\n<span class="token keyword">function</span> <span class="token function">mountElement</span><span class="token punctuation">(</span><span class="token parameter">vnode<span class="token punctuation">,</span> container</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token keyword">const</span> el <span class="token operator">=</span> <span class="token function">createElement</span><span class="token punctuation">(</span>vnode<span class="token punctuation">.</span>type<span class="token punctuation">)</span>\n  <span class="token comment">// çœç•¥ children çš„å¤„ç†</span>\n\n  <span class="token keyword">if</span> <span class="token punctuation">(</span>vnode<span class="token punctuation">.</span>props<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> key <span class="token keyword">in</span> vnode<span class="token punctuation">.</span>props<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">shouldSetAsProps</span><span class="token punctuation">(</span>el<span class="token punctuation">,</span> key<span class="token punctuation">,</span> nextValue<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token keyword">const</span> type <span class="token operator">=</span> <span class="token keyword">typeof</span> el<span class="token punctuation">[</span>key<span class="token punctuation">]</span>\n        <span class="token keyword">if</span> <span class="token punctuation">(</span>type <span class="token operator">===</span> <span class="token string">&#39;boolean&#39;</span> <span class="token operator">&amp;&amp;</span> nextValue <span class="token operator">===</span> <span class="token string">&#39;&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n          el<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">true</span>\n        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>\n          el<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> nextValue\n        <span class="token punctuation">}</span>\n      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>\n        el<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> nextValue<span class="token punctuation">)</span>\n      <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n  <span class="token punctuation">}</span>\n\n  <span class="token function">insert</span><span class="token punctuation">(</span>el<span class="token punctuation">,</span> container<span class="token punctuation">)</span>\n<span class="token punctuation">}</span>\n</code></pre><div class="highlight-lines"><br><br><br><br><br><br><br><br><br><br><br><br><br><div class="highlight-line">Â </div><br><div class="highlight-line">Â </div><br><br><br><br><br><br><br><br><br><br><br><br></div><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br></div></div><hr><p>æœ€åï¼Œæˆ‘ä»¬éœ€è¦æŠŠå±æ€§è®¾ç½®çš„ä¹Ÿå˜æˆä¸å¹³å°æ— å…³ï¼Œå› æ­¤éœ€è¦æŠŠå±æ€§è®¾ç½®çš„ç›¸å…³æ“ä½œä¹Ÿæå–åˆ°æ¸²æŸ“é€‰é¡¹ä¸­ï¼š</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> renderer <span class="token operator">=</span> <span class="token function">createRenderer</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n  <span class="token function">createElement</span><span class="token punctuation">(</span><span class="token parameter">tag</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">return</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span>tag<span class="token punctuation">)</span>\n  <span class="token punctuation">}</span><span class="token punctuation">,</span>\n  <span class="token function">setElementText</span><span class="token punctuation">(</span><span class="token parameter">el<span class="token punctuation">,</span> text</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    el<span class="token punctuation">.</span>textContent <span class="token operator">=</span> text\n  <span class="token punctuation">}</span><span class="token punctuation">,</span>\n  <span class="token function">insert</span><span class="token punctuation">(</span><span class="token parameter">el<span class="token punctuation">,</span> parent<span class="token punctuation">,</span> anchor <span class="token operator">=</span> <span class="token keyword">null</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    parent<span class="token punctuation">.</span><span class="token function">insertBefore</span><span class="token punctuation">(</span>el<span class="token punctuation">,</span> anchor<span class="token punctuation">)</span>\n  <span class="token punctuation">}</span><span class="token punctuation">,</span>\n  <span class="token comment">// å°†å±æ€§è®¾ç½®ç›¸å…³æ“ä½œå°è£…åˆ° pathProps å‡½æ•°ä¸­ï¼Œå¹¶ä½œä¸ºæ¸²æŸ“å™¨é€‰é¡¹ä¼ é€’</span>\n  <span class="token function">patchProps</span><span class="token punctuation">(</span><span class="token parameter">el<span class="token punctuation">,</span> key<span class="token punctuation">,</span> preValue<span class="token punctuation">,</span> nextValue</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">shouldSetAsProps</span><span class="token punctuation">(</span>el<span class="token punctuation">,</span> key<span class="token punctuation">,</span> nextValue<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      <span class="token keyword">const</span> type <span class="token operator">=</span> <span class="token keyword">typeof</span> el<span class="token punctuation">[</span>key<span class="token punctuation">]</span>\n      <span class="token keyword">if</span> <span class="token punctuation">(</span>type <span class="token operator">===</span> <span class="token string">&#39;boolean&#39;</span> <span class="token operator">&amp;&amp;</span> nextValue <span class="token operator">===</span> <span class="token string">&#39;&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        el<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">true</span>\n      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>\n        el<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> nextValue\n      <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>\n      el<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> nextValue<span class="token punctuation">)</span>\n    <span class="token punctuation">}</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span>\n</code></pre><div class="highlight-lines"><br><br><br><br><br><br><br><br><br><br><br><div class="highlight-line">Â </div><div class="highlight-line">Â </div><div class="highlight-line">Â </div><div class="highlight-line">Â </div><div class="highlight-line">Â </div><div class="highlight-line">Â </div><div class="highlight-line">Â </div><div class="highlight-line">Â </div><div class="highlight-line">Â </div><div class="highlight-line">Â </div><div class="highlight-line">Â </div><br><br></div><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><p>è€Œåœ¨ mountElement å‡½æ•°ä¸­ï¼Œåªéœ€è¦è°ƒç”¨ patchProps å‡½æ•°ï¼Œå¹¶ä¼ é€’ç›¸å…³å‚æ•°å³å¯ï¼š</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">mountElement</span><span class="token punctuation">(</span><span class="token parameter">vnode<span class="token punctuation">,</span> container</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token keyword">const</span> el <span class="token operator">=</span> <span class="token function">createElement</span><span class="token punctuation">(</span>vnode<span class="token punctuation">.</span>type<span class="token punctuation">)</span>\n  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> vnode<span class="token punctuation">.</span>children <span class="token operator">===</span> <span class="token string">&#39;string&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token function">setElementText</span><span class="token punctuation">(</span>el<span class="token punctuation">,</span> vnode<span class="token punctuation">.</span>children<span class="token punctuation">)</span>\n  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>Array<span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span>vnode<span class="token punctuation">.</span>children<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    vnode<span class="token punctuation">.</span>children<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">child</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>\n      <span class="token function">patch</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> child<span class="token punctuation">,</span> el<span class="token punctuation">)</span>\n    <span class="token punctuation">}</span><span class="token punctuation">)</span>\n  <span class="token punctuation">}</span>\n\n  <span class="token keyword">if</span> <span class="token punctuation">(</span>vnode<span class="token punctuation">.</span>props<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> key <span class="token keyword">in</span> vnode<span class="token punctuation">.</span>props<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      <span class="token function">patchProps</span><span class="token punctuation">(</span>el<span class="token punctuation">,</span> key<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> vnode<span class="token punctuation">.</span>props<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">)</span>\n    <span class="token punctuation">}</span>\n  <span class="token punctuation">}</span>\n\n  <span class="token function">insert</span><span class="token punctuation">(</span>el<span class="token punctuation">,</span> container<span class="token punctuation">)</span>\n<span class="token punctuation">}</span>\n</code></pre><div class="highlight-lines"><br><br><br><br><br><br><br><br><br><br><br><br><div class="highlight-line">Â </div><br><br><br><br><br></div><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><h2 id="class-çš„å¤„ç†" tabindex="-1"><a class="header-anchor" href="#class-çš„å¤„ç†" aria-hidden="true">#</a> class çš„å¤„ç†</h2><h3 id="class-å€¼å¤„ç†" tabindex="-1"><a class="header-anchor" href="#class-å€¼å¤„ç†" aria-hidden="true">#</a> class å€¼å¤„ç†</h3><p>Vue.js å…è®¸é€šè¿‡å¤šç§æ–¹å¼è®¾ç½®å…ƒç´ ç±»åï¼š</p><div class="language-html ext-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>foo bar<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">:class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>{ foo: true, bar:false}<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">:class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>arr<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>\n\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">\n<span class="token keyword">const</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span>\n  <span class="token string">&#39;foo bar&#39;</span><span class="token punctuation">,</span>\n  <span class="token punctuation">{</span>\n    baz<span class="token operator">:</span> <span class="token boolean">true</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">]</span>\n</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p>ç¬¬ä¸‰ä¸ª p æ ‡ç­¾å¯¹åº”çš„ vnode å¦‚ä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥å°è£…ä¸€ä¸ª normalizeClass å‡½æ•°å°†å…¶å¤„ç†ä¸ºæ­£å¸¸çš„å­—ç¬¦ä¸²ï¼š</p>',60),e=(0,t._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t._)("pre",{class:"language-javascript"},[(0,t._)("code",null,[(0,t._)("span",{class:"token keyword"},"const"),(0,t.Uk)(" vnode "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n  type"),(0,t._)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"'p'"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)("\n  props"),(0,t._)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token keyword"},"class"),(0,t._)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"["),(0,t.Uk)("\n      "),(0,t._)("span",{class:"token string"},"'bar foo'"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)("\n      "),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)(" baz"),(0,t._)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t._)("span",{class:"token boolean"},"true"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token punctuation"},"]"),(0,t.Uk)("\n  "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n")])]),(0,t._)("div",{class:"line-numbers"},[(0,t._)("span",{class:"line-number"},"1"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"2"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"3"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"4"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"5"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"6"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"7"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"8"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"9"),(0,t._)("br")])],-1),o=(0,t._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t._)("pre",{class:"language-javascript"},[(0,t._)("code",null,[(0,t._)("span",{class:"token keyword"},"const"),(0,t.Uk)(" vnode "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n  type"),(0,t._)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"'p'"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)("\n  props"),(0,t._)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token keyword"},"class"),(0,t._)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"normalizeClass"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},"["),(0,t.Uk)("\n      "),(0,t._)("span",{class:"token string"},"'bar foo'"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)("\n      "),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)(" baz"),(0,t._)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t._)("span",{class:"token boolean"},"true"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token punctuation"},"]"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n  "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n")])]),(0,t._)("div",{class:"line-numbers"},[(0,t._)("span",{class:"line-number"},"1"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"2"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"3"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"4"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"5"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"6"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"7"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"8"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"9"),(0,t._)("br")])],-1),c=(0,t._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t._)("pre",{class:"language-javascript"},[(0,t._)("code",null,[(0,t._)("span",{class:"token keyword"},"const"),(0,t.Uk)(" vnode "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n  type"),(0,t._)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"'p'"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)("\n  props"),(0,t._)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token comment"},"// åºåˆ—åŒ–åçš„ç»“æœ"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token keyword"},"class"),(0,t._)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"'foo bar baz'"),(0,t.Uk)("\n  "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n")])]),(0,t._)("div",{class:"line-numbers"},[(0,t._)("span",{class:"line-number"},"1"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"2"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"3"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"4"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"5"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"6"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"7"),(0,t._)("br")])],-1),l=(0,t.uE)('<h3 id="å…ƒç´ è®¾ç½®-class" tabindex="-1"><a class="header-anchor" href="#å…ƒç´ è®¾ç½®-class" aria-hidden="true">#</a> å…ƒç´ è®¾ç½® class</h3><p>åœ¨å°† vnode çš„ class å€¼æ­£å¸¸åŒ–ä¹‹åï¼Œè¿˜è¦é€šè¿‡é«˜æ•ˆçš„æ–¹å¼æŠŠ class è®¾ç½®åˆ°å…ƒç´ ä¸Šï¼š</p><table><thead><tr><th>Text name</th><th>Execution per second</th></tr></thead><tbody><tr><td>el.className</td><td>9637.7 Ops/sec</td></tr><tr><td>el.classList</td><td>5969.5 Ops/sec</td></tr><tr><td>setAttribute</td><td>4761.1 Ops/sec</td></tr></tbody></table><p>ğŸ”¥ å¯ä»¥å‘ç°ï¼ŒclassName æ¯ç§’è®¾ç½®çš„åšå¤šæ¬¡ï¼Œæ€§èƒ½æœ€ä¼˜ã€‚å› æ­¤æˆ‘ä»¬éœ€è¦è°ƒæ•´ patchProps å‡½æ•°çš„å®ç°ï¼š</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code>\n<span class="token keyword">const</span> renderer <span class="token operator">=</span> <span class="token function">createRenderer</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n  <span class="token comment">// çœç•¥å…¶ä»–å¹³å°æ“ä½œ API</span>\n  \n  <span class="token function">patchProps</span><span class="token punctuation">(</span><span class="token parameter">el<span class="token punctuation">,</span> key<span class="token punctuation">,</span> preValue<span class="token punctuation">,</span> nextValue</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">if</span> <span class="token punctuation">(</span>key <span class="token operator">===</span> <span class="token string">&#39;class&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      el<span class="token punctuation">.</span>className <span class="token operator">=</span> nextValue <span class="token operator">||</span> <span class="token string">&#39;&#39;</span>\n    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">shouldSetAsProps</span><span class="token punctuation">(</span>el<span class="token punctuation">,</span> key<span class="token punctuation">,</span> nextValue<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      <span class="token keyword">const</span> type <span class="token operator">=</span> <span class="token keyword">typeof</span> el<span class="token punctuation">[</span>key<span class="token punctuation">]</span>\n      <span class="token keyword">if</span> <span class="token punctuation">(</span>type <span class="token operator">===</span> <span class="token string">&#39;boolean&#39;</span> <span class="token operator">&amp;&amp;</span> nextValue <span class="token operator">===</span> <span class="token string">&#39;&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        el<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">true</span>\n      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>\n        el<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> nextValue\n      <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>\n      el<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> nextValue<span class="token punctuation">)</span>\n    <span class="token punctuation">}</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><p>ğŸ“ å¯è§ï¼Œ vnode.props å¯¹è±¡ä¸­å®šä¹‰çš„å±æ€§å€¼ç±»å‹å¹¶ä¸æ€»æ˜¯ä¸ DOM å…ƒç´ å±æ€§çš„æ•°æ®ç»“æ„ä¿æŒä¸€è‡´ï¼Œè¿™å–å†³äºä¸Šå±‚è®¾è®¡ã€‚Vue.js å…è®¸å¯¹è±¡ç±»å‹çš„å€¼ä½œä¸º class æ˜¯ä¸ºäº†æ–¹ä¾¿å¼€å‘è€…ï¼Œåœ¨åº•å±‚å®ç°ä¸Šï¼Œå¿…ç„¶éœ€è¦å¯¹å€¼è¿›è¡Œæ­£å¸¸åŒ–åå†ä½¿ç”¨ã€‚å¦å¤–ï¼Œæ­£å¸¸åŒ–å€¼çš„è¿‡ç¨‹æ˜¯æœ‰ä»£ä»·çš„ï¼Œå¦‚æœéœ€è¦å¤§é‡çš„æ­£å¸¸åŒ–æ“ä½œï¼Œåˆ™ä¼šæ¶ˆè€—æ›´å¤šçš„æ€§èƒ½ã€‚</p><h2 id="å¸è½½æ“ä½œ" tabindex="-1"><a class="header-anchor" href="#å¸è½½æ“ä½œ" aria-hidden="true">#</a> å¸è½½æ“ä½œ</h2><div class="custom-container warning"><p class="custom-container-title">æ“ä½œè¡¨ç¤ºåˆ¤æ–­ newVNode ä¸ºç©ºï¼Œéœ€è¦æŠŠä¹‹å‰æ¸²æŸ“çš„å†…å®¹å¸è½½ï¼Œç›®å‰ render å‡½æ•°ç›´æ¥æŠŠ innerHTML æ¸…ç©ºã€‚è¿™ä¹ˆåšæ˜¯ä¸ä¸¥è°¨çš„ï¼š</p><ul><li>å®¹å™¨çš„å†…å®¹å¯èƒ½æ˜¯ç”±æŸä¸ªæˆ–å¤šä¸ªç»„ä»¶æ¸²æŸ“çš„ï¼Œå½“å¸è½½æ“ä½œå‘ç”Ÿæ—¶ï¼Œåº”è¯¥æ­£ç¡®åœ°è°ƒç”¨è¿™äº›ç»„ä»¶çš„ beforeUnmountã€unmounted ç­‰å£°æ˜å‘¨æœŸå‡½æ•°</li><li>å³ä½¿å†…å®¹ä¸æ˜¯ç”±ç»„ä»¶æ¸²æŸ“çš„ï¼Œæœ‰çš„å…ƒç´ å­˜åœ¨è‡ªå®šä¹‰æŒ‡ä»¤ï¼Œæˆ‘ä»¬åº”è¯¥åœ¨å¸è½½æ“ä½œå‘ç”Ÿæ—¶æ­£ç¡®æ‰§è¡Œå¯¹åº”çš„å€¼ä»¤é’©å­å‡½æ•°</li><li>ä½¿ç”¨ innerHTML æ¸…ç©ºå®¹å™¨å…ƒç´ å†…å®¹çš„å¦å¤–ä¸€ä¸ªç¼ºé™·æ˜¯ï¼Œå®ƒä¸ä¼šç§»é™¤ç»‘å®šåœ¨ DOM å…ƒç´ ä¸Šçš„äº‹ä»¶å¤„ç†å‡½æ•°</li></ul></div><p>æ­£ç¡®çš„å¸è½½æ–¹å¼æ˜¯ï¼Œæ ¹æ® vnode å¯¹è±¡è·å–ä¸å…¶ç›¸å…³çš„çœŸå® DOM å…ƒç´ ï¼Œç„¶åä½¿ç”¨åŸç”Ÿ DOM æ“ä½œæ–¹æ³•å°†è¯¥ DOM å…ƒç´ ç§»é™¤ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬éœ€è¦åœ¨ vnode ä¸çœŸå® DOM å…ƒç´ ä¹‹é—´å»ºç«‹è”ç³»ï¼Œä¿®æ”¹ mountElement å‡½æ•°ï¼š</p>',9),u=(0,t._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t._)("pre",{class:"language-javascript"},[(0,t._)("code",null,[(0,t._)("span",{class:"token keyword"},"function"),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"mountElement"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},[(0,t.Uk)("vnode"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" container")]),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n  "),(0,t._)("span",{class:"token comment"},"// è®© vnode.el å¼•ç”¨çœŸå® DOM å…ƒç´ "),(0,t.Uk)("\n  "),(0,t._)("span",{class:"token keyword"},"const"),(0,t.Uk)(" el "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" vnode"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("el "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"createElement"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("vnode"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("type"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n  "),(0,t._)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token keyword"},"typeof"),(0,t.Uk)(" vnode"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("children "),(0,t._)("span",{class:"token operator"},"==="),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"'string'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token function"},"setElementText"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("el"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" vnode"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("children"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n  "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"else"),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("Array"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"isArray"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("vnode"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("children"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    vnode"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("children"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"forEach"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},"child"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"=>"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n      "),(0,t._)("span",{class:"token function"},"patch"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token keyword"},"null"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" child"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" el"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n  "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n\n  "),(0,t._)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("vnode"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("props"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token keyword"},"for"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token keyword"},"const"),(0,t.Uk)(" key "),(0,t._)("span",{class:"token keyword"},"in"),(0,t.Uk)(" vnode"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("props"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n      "),(0,t._)("span",{class:"token function"},"patchProps"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("el"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" key"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"null"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" vnode"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("props"),(0,t._)("span",{class:"token punctuation"},"["),(0,t.Uk)("key"),(0,t._)("span",{class:"token punctuation"},"]"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n  "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n\n  "),(0,t._)("span",{class:"token function"},"insert"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("el"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" container"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n")])]),(0,t._)("div",{class:"highlight-lines"},[(0,t._)("br"),(0,t._)("br"),(0,t._)("div",{class:"highlight-line"},"Â "),(0,t._)("br"),(0,t._)("br"),(0,t._)("br"),(0,t._)("br"),(0,t._)("br"),(0,t._)("br"),(0,t._)("br"),(0,t._)("br"),(0,t._)("br"),(0,t._)("br"),(0,t._)("br"),(0,t._)("br"),(0,t._)("br"),(0,t._)("br"),(0,t._)("br"),(0,t._)("br")]),(0,t._)("div",{class:"line-numbers"},[(0,t._)("span",{class:"line-number"},"1"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"2"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"3"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"4"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"5"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"6"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"7"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"8"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"9"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"10"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"11"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"12"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"13"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"14"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"15"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"16"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"17"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"18"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"19"),(0,t._)("br")])],-1),i=(0,t._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t._)("pre",{class:"language-javascript"},[(0,t._)("code",null,[(0,t._)("span",{class:"token keyword"},"function"),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"unmount"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},"vnode"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n  "),(0,t._)("span",{class:"token keyword"},"const"),(0,t.Uk)(" parent "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" vnode"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("el"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("parentNode\n  "),(0,t._)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("parent"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    parent"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"removeChild"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("vnode"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("el"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n  "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n")])]),(0,t._)("div",{class:"line-numbers"},[(0,t._)("span",{class:"line-number"},"1"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"2"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"3"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"4"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"5"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"6"),(0,t._)("br")])],-1),k=(0,t._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t._)("pre",{class:"language-javascript"},[(0,t._)("code",null,[(0,t._)("span",{class:"token keyword"},"function"),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"render"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},[(0,t.Uk)("vnode"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" container")]),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n  "),(0,t._)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("vnode"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token comment"},"// æ–° vnode å­˜åœ¨ï¼Œå°†å…¶ä¸æ—§ vnode ä¸€èµ·ä¼ é€’ç»™ patch å‡½æ•°è¿›è¡Œæ‰“è¡¥ä¸"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token function"},"patch"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("container"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("_vnode"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" vnode"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" container"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n  "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"else"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("container"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("_vnode"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n      "),(0,t._)("span",{class:"token comment"},"// è°ƒç”¨ unmount å‡½æ•°å¸è½½ "),(0,t.Uk)("\n      "),(0,t._)("span",{class:"token function"},"unmount"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("container"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("_vnode"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n  "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n  "),(0,t._)("span",{class:"token comment"},"// æŠŠ vnode å­˜å‚¨åˆ° container._vnode"),(0,t.Uk)("\n  container"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("_vnode "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" vnode\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n")])]),(0,t._)("div",{class:"highlight-lines"},[(0,t._)("br"),(0,t._)("br"),(0,t._)("br"),(0,t._)("br"),(0,t._)("br"),(0,t._)("div",{class:"highlight-line"},"Â "),(0,t._)("div",{class:"highlight-line"},"Â "),(0,t._)("div",{class:"highlight-line"},"Â "),(0,t._)("div",{class:"highlight-line"},"Â "),(0,t._)("br"),(0,t._)("br"),(0,t._)("br"),(0,t._)("br")]),(0,t._)("div",{class:"line-numbers"},[(0,t._)("span",{class:"line-number"},"1"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"2"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"3"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"4"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"5"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"6"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"7"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"8"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"9"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"10"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"11"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"12"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"13"),(0,t._)("br")])],-1),r=(0,t.uE)('<div class="custom-container tip"><p class="custom-container-title">å°†å¸è½½æ“ä½œå°è£…åˆ° unmount ä¸­ï¼Œè¿˜èƒ½å¤Ÿå¸¦æ¥ä¸¤ç‚¹é¢å¤–çš„å¥½å¤„ï¼š</p><ul><li>åœ¨ unmount å‡½æ•°å†…ï¼Œæˆ‘ä»¬æœ‰æœºä¼šè°ƒç”¨ç»‘å®šåœ¨ DOM å…ƒç´ ä¸Šçš„æŒ‡ä»¤é’©å­å‡½æ•°ï¼Œä¾‹å¦‚ beforeUnmountã€unmounted ç­‰</li><li>å½“ unmount å‡½æ•°æ‰§è¡Œæ—¶ï¼Œæˆ‘ä»¬æœ‰æœºä¼šæ£€æµ‹è™šæ‹ŸèŠ‚ç‚¹ vnode çš„ç±»å‹ã€‚å¦‚æœè¯¥è™šæ‹ŸèŠ‚ç‚¹æè¿°çš„æ˜¯ç»„ä»¶ï¼Œåˆ™æˆ‘ä»¬æœ‰æœºä¼šè°ƒç”¨ç»„ä»¶ç›¸å…³çš„ç”Ÿå‘½å‘¨æœŸå‡½æ•°</li></ul></div><h2 id="åŒºåˆ†-vode-çš„ç±»å‹" tabindex="-1"><a class="header-anchor" href="#åŒºåˆ†-vode-çš„ç±»å‹" aria-hidden="true">#</a> åŒºåˆ† vode çš„ç±»å‹</h2><p>ç›®å‰ï¼Œpatch å‡½æ•°åœ¨åˆ¤æ–­åˆ°æ—§ vnode ä¸å­˜åœ¨æ—¶ï¼Œä¼šèµ° mountElement è¿›è¡ŒæŒ‚è½½ï¼Œå¦åˆ™å°±æ‰§è¡Œ DOM æ›´æ–°é€»è¾‘ã€‚</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">patch</span><span class="token punctuation">(</span><span class="token parameter">n1<span class="token punctuation">,</span> n2<span class="token punctuation">,</span> container</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>n1<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token function">mountElement</span><span class="token punctuation">(</span>n2<span class="token punctuation">,</span> container<span class="token punctuation">)</span>\n  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>\n    <span class="token comment">// æ›´æ–°</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><div class="custom-container tip"><p class="custom-container-title">vnode çš„åŒºåˆ†å¤„ç†</p><ol><li><p>é¦–å…ˆè¦åˆ¤æ–­æ–°æ—§ vnode æ‰€æè¿°çš„å†…å®¹ç›¸åŒï¼Œå› ä¸ºå°±ä¸åŒå…ƒç´ æ¥è¯´ï¼Œæ¯ä¸ªå…ƒç´ éƒ½æœ‰ç‰¹æœ‰çš„å±æ€§ï¼Œ</p><p>å¦åˆ™è¿™å°±æ˜¯ä¸€ä¸ªå•çº¯çš„å¸è½½å†æŒ‚è½½çš„æ“ä½œï¼Œæ˜¯ä¸éœ€è¦èµ° patchçš„ã€‚</p></li><li><p>å¦å¤–ï¼Œvnode å¯ä»¥æè¿°æ™®é€šæ ‡ç­¾ã€ç»„ä»¶ã€Fragmentç­‰ç­‰ï¼Œ</p><p>æ‰€ä»¥ä¸åŒç±»å‹çš„ vnode æˆ‘ä»¬è¦ä½¿ç”¨ä¸åŒçš„æŒ‚è½½æˆ–è€…æ‰“è¡¥ä¸çš„å¤„ç†æ–¹å¼ï¼›</p></li></ol></div><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">patch</span><span class="token punctuation">(</span><span class="token parameter">n1<span class="token punctuation">,</span> n2<span class="token punctuation">,</span> container</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token comment">// åœ¨çœŸæ­£æ‰§è¡Œæ›´æ–°æ“ä½œä¹‹å‰ï¼Œæˆ‘ä»¬ä¼˜å…ˆæ£€æŸ¥æ–°æ—§ vnode æ‰€æè¿°çš„å†…å®¹æ˜¯å¦ç›¸åŒ</span>\n  <span class="token keyword">if</span> <span class="token punctuation">(</span>n1 <span class="token operator">&amp;&amp;</span> n1<span class="token punctuation">.</span>type <span class="token operator">!==</span> n2<span class="token punctuation">.</span>type<span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token comment">// p\\input\\div...</span>\n    <span class="token function">unmount</span><span class="token punctuation">(</span>n1<span class="token punctuation">)</span>\n    n1 <span class="token operator">=</span> <span class="token keyword">null</span>\n  <span class="token punctuation">}</span>\n\n  <span class="token keyword">const</span> <span class="token punctuation">{</span> type <span class="token punctuation">}</span> <span class="token operator">=</span> n2\n\n  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> type <span class="token operator">===</span> <span class="token string">&#39;string&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>n1<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      <span class="token function">mountElement</span><span class="token punctuation">(</span>n2<span class="token punctuation">,</span> container<span class="token punctuation">)</span>\n    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>\n      <span class="token function">patchElement</span><span class="token punctuation">(</span>n1<span class="token punctuation">,</span> n2<span class="token punctuation">)</span>\n    <span class="token punctuation">}</span>\n  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> type <span class="token operator">===</span> <span class="token string">&#39;object&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token comment">// ç»„ä»¶</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n</code></pre><div class="highlight-lines"><br><br><div class="highlight-line">Â </div><div class="highlight-line">Â </div><div class="highlight-line">Â </div><div class="highlight-line">Â </div><br><br><br><div class="highlight-line">Â </div><br><br><br><br><br><div class="highlight-line">Â </div><br><br><br></div><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><h2 id="äº‹ä»¶çš„å¤„ç†" tabindex="-1"><a class="header-anchor" href="#äº‹ä»¶çš„å¤„ç†" aria-hidden="true">#</a> äº‹ä»¶çš„å¤„ç†</h2><div class="custom-container tip"><p class="custom-container-title">äº‹ä»¶çš„å¤„ç†ä¸ä¼˜åŒ–</p><ul><li><p>äº‹ä»¶å¯ä»¥è§†ä½œä¸€ç§ç‰¹æ®Šçš„å±æ€§ï¼Œæˆ‘ä»¬å¯ä»¥çº¦å®šï¼Œåœ¨ vnode.props å¯¹è±¡ä¸­ï¼Œå‡¡æ˜¯ä»¥å­—ç¬¦ on å¼€å¤´çš„å±æ€§éƒ½è§†ä½œäº‹ä»¶ã€‚</p></li><li><p>äº‹ä»¶çš„æ·»åŠ å¯ä»¥è°ƒç”¨ addEventListener å‡½æ•°æ¥ç»‘å®šã€‚</p><p>ä¸€ä¸ªå…ƒç´ å¯ä»¥ç»‘å®šå¤šç§ç±»å‹çš„äº‹ä»¶ï¼Œå¯¹äºåŒä¸€ç±»å‹äº‹ä»¶è€Œè¨€ï¼Œè¿˜å¯ä»¥ç»‘å®šå¤šä¸ªäº‹ä»¶å¤„ç†å‡½æ•°ã€‚</p></li><li><p>äº‹ä»¶çš„æ›´æ–°æŒ‰ä¸€èˆ¬çš„æ€è·¯å°±æ˜¯å…ˆç§»é™¤ä¹‹å‰æ·»åŠ çš„äº‹ä»¶å¤„ç†å‡½æ•°ï¼Œå†ç»‘å®šæ–°çš„åˆ° DOM å…ƒç´ ä¸Šã€‚</p><p>è¿™ä¹ˆåšä»£ç èƒ½å¤ŸæŒ‰ç…§é¢„æœŸå·¥ä½œï¼Œä½†æ˜¯æœ‰<strong>æ€§èƒ½æ›´ä¼˜çš„å¤„ç†</strong>åŠæ³•ã€‚æˆ‘ä»¬å¯ä»¥ä¼ªè£…ä¸€ä¸ªäº‹ä»¶å¤„ç†å‡½æ•° invokerï¼ŒæŠŠçœŸæ­£çš„äº‹ä»¶å¤„ç†å‡½æ•°è®¾ç½®ä¸º invoker.value çš„å€¼ã€‚è¿™æ ·åœ¨æ›´æ–°äº‹ä»¶çš„æ—¶å€™ï¼Œæˆ‘ä»¬å°†ä¸å†éœ€è¦è°ƒç”¨ removeEventListener å‡½æ•°æ¥ç§»é™¤ä¸Šä¸€æ¬¡ç»‘å®šçš„äº‹ä»¶ï¼Œåªéœ€è¦æ›´æ–° invoker.value çš„å€¼å³å¯ã€‚</p></li></ul></div><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token function">patchProps</span><span class="token punctuation">(</span><span class="token parameter">el<span class="token punctuation">,</span> key<span class="token punctuation">,</span> prevValue<span class="token punctuation">,</span> nextValue</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">^on</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token comment">// invokers å¯¹è±¡ä¿å­˜ç€å„ç§äº‹ä»¶çš„å¤„ç†å‡½æ•°</span>\n    <span class="token comment">// invoker çš„å±æ€§ value å±æ€§ï¼Œä¿å­˜ç€ä¸€ä¸ªæˆ–å¤šä¸ªäº‹ä»¶å¤„ç†å‡½æ•°</span>\n    <span class="token keyword">const</span> invokers <span class="token operator">=</span> el<span class="token punctuation">.</span>_vei <span class="token operator">||</span> <span class="token punctuation">(</span>el<span class="token punctuation">.</span>_vei <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>\n    <span class="token keyword">let</span> invoker <span class="token operator">=</span> invokers<span class="token punctuation">[</span>key<span class="token punctuation">]</span>\n    <span class="token keyword">const</span> name <span class="token operator">=</span> key<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toLowerCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token keyword">if</span> <span class="token punctuation">(</span>nextValue<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      <span class="token comment">// äº‹ä»¶å‡½æ•°åˆå§‹å£°æ˜ä¸ç»‘å®š</span>\n      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>invoker<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token comment">// invoker å£°æ˜ä¸ºä¸€ä¸ªå‡½æ•°ï¼Œè§¦å‘å…¶ value å±æ€§ä¿å­˜çš„äº‹ä»¶</span>\n        invoker <span class="token operator">=</span> el<span class="token punctuation">.</span>_vei<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>\n          <span class="token keyword">if</span> <span class="token punctuation">(</span>Array<span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span>invoker<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n            invoker<span class="token punctuation">.</span>value<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">fn</span> <span class="token operator">=&gt;</span> <span class="token function">fn</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">)</span>\n          <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>\n            invoker<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span>\n          <span class="token punctuation">}</span>\n        <span class="token punctuation">}</span>\n        invoker<span class="token punctuation">.</span>value <span class="token operator">=</span> nextValue\n        el<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> invoker<span class="token punctuation">)</span>\n      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>\n      \t<span class="token comment">// ç»‘å®šäº‹ä»¶åç»­çš„æ›´æ–°ï¼Œé¿å…äº†ä¸€æ¬¡ removeEventListener çš„è°ƒç”¨</span>\n        invoker<span class="token punctuation">.</span>value <span class="token operator">=</span> nextValue\n      <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>invoker<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      el<span class="token punctuation">.</span><span class="token function">removeEventListener</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> invoker<span class="token punctuation">)</span>\n    <span class="token punctuation">}</span>\n  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>key <span class="token operator">===</span> <span class="token string">&#39;class&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    el<span class="token punctuation">.</span>className <span class="token operator">=</span> nextValue <span class="token operator">||</span> <span class="token string">&#39;&#39;</span>\n  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">shouldSetAsProps</span><span class="token punctuation">(</span>el<span class="token punctuation">,</span> key<span class="token punctuation">,</span> nextValue<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">const</span> type <span class="token operator">=</span> <span class="token keyword">typeof</span> el<span class="token punctuation">[</span>key<span class="token punctuation">]</span>\n    <span class="token keyword">if</span> <span class="token punctuation">(</span>type <span class="token operator">===</span> <span class="token string">&#39;boolean&#39;</span> <span class="token operator">&amp;&amp;</span> nextValue <span class="token operator">===</span> <span class="token string">&#39;&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      el<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">true</span>\n    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>\n      el<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> nextValue\n    <span class="token punctuation">}</span>\n  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>\n    el<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> nextValue<span class="token punctuation">)</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n</code></pre><div class="highlight-lines"><br><br><br><br><div class="highlight-line">Â </div><div class="highlight-line">Â </div><br><br><br><br><br><div class="highlight-line">Â </div><br><br><br><br><br><br><div class="highlight-line">Â </div><div class="highlight-line">Â </div><br><br><div class="highlight-line">Â </div><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br></div><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br></div></div><h2 id="æ—¶é—´å†’æ³¡ä¸æ›´æ–°æ—¶æœº" tabindex="-1"><a class="header-anchor" href="#æ—¶é—´å†’æ³¡ä¸æ›´æ–°æ—¶æœº" aria-hidden="true">#</a> æ—¶é—´å†’æ³¡ä¸æ›´æ–°æ—¶æœº</h2><p>ç›®å‰çš„åŸºæœ¬äº‹ä»¶å¤„ç†ä»£ç ï¼Œåœ¨äº‹ä»¶å†’æ³¡ä¸æ›´æ–°æ—¶æœºç›¸ç»“åˆä¼šå¯¼è‡´çš„é—®é¢˜ã€‚</p><h3 id="é—®é¢˜åˆ†æ" tabindex="-1"><a class="header-anchor" href="#é—®é¢˜åˆ†æ" aria-hidden="true">#</a> é—®é¢˜åˆ†æ</h3><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> <span class="token punctuation">{</span> effect<span class="token punctuation">,</span> ref <span class="token punctuation">}</span> <span class="token operator">=</span> VueReactivity\n\n<span class="token keyword">const</span> bol <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span>\n\n<span class="token function">effect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>\n    <span class="token comment">// åˆ›å»º vnode</span>\n    <span class="token keyword">const</span> vnode <span class="token operator">=</span> <span class="token punctuation">{</span>\n        type<span class="token operator">:</span> <span class="token string">&#39;div&#39;</span><span class="token punctuation">,</span>\n        props<span class="token operator">:</span> bol<span class="token punctuation">.</span>value <span class="token operator">?</span> <span class="token punctuation">{</span>\n            <span class="token function-variable function">onClick</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>\n                <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">&#39;çˆ¶å…ƒç´  clicked&#39;</span><span class="token punctuation">)</span>\n            <span class="token punctuation">}</span>\n        <span class="token punctuation">}</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>\n        children<span class="token operator">:</span> <span class="token punctuation">[</span>\n            <span class="token punctuation">{</span>\n                type<span class="token operator">:</span> <span class="token string">&#39;p&#39;</span><span class="token punctuation">,</span>\n                props<span class="token operator">:</span> <span class="token punctuation">{</span>\n                    <span class="token function-variable function">onClick</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>\n                        bol<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token boolean">true</span>\n                    <span class="token punctuation">}</span>\n                <span class="token punctuation">}</span><span class="token punctuation">,</span>\n                children<span class="token operator">:</span> <span class="token string">&#39;text&#39;</span>\n            <span class="token punctuation">}</span>\n        <span class="token punctuation">]</span>\n    <span class="token punctuation">}</span>\n    <span class="token comment">// æ¸²æŸ“ vnode</span>\n    renderer<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span>vnode<span class="token punctuation">,</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&#39;#app&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br></div></div><ul><li>div å…ƒç´ ï¼šå®ƒçš„ props å¯¹è±¡çš„å€¼æ˜¯ç”±ä¸€ä¸ªä¸‰å…ƒè¡¨è¾¾å¼å†³å®šçš„ã€‚åœ¨é¦–æ¬¡æ¸²æŸ“æ—¶ï¼Œç”±äº bol.value çš„å€¼ä¸º falseï¼Œæ‰€ä»¥å®ƒçš„ props å€¼æ˜¯ä¸€ä¸ªç©ºå¯¹è±¡</li><li>p å…ƒç´ ï¼šå®ƒå…·æœ‰ click ç‚¹å‡»äº‹ä»¶ï¼Œå¹¶ä¸”ç‚¹å‡»å®ƒæ—¶ï¼Œäº‹ä»¶å¤„ç†å‡½æ•°ä¼šå°† bol.value çš„å€¼è®¾ç½®ä¸º true</li></ul><p>ğŸ§ é‚£ä¹ˆï¼Œå½“é¦–æ­¤æ¸²æŸ“ä¹‹åï¼Œé¼ æ ‡ç‚¹å‡» p æ ‡ç­¾ï¼Œ ä¼šè§¦å‘çˆ¶å…ƒç´ div æ ‡ç­¾çš„ click äº‹ä»¶å¤„ç†å‡½æ•°æ‰§è¡Œå—ï¼Ÿ</p><p>â¬†ï¸ é¢„æœŸæ˜¯ï¼Œå½“ p ç‚¹å‡»æ—¶ï¼Œæ­¤æ—¶çš„ div æ ‡ç­¾æ²¡æœ‰ç»‘å®šäº‹ä»¶å¤„ç†å‡½æ•°ï¼Œåº”è¯¥ä»€ä¹ˆéƒ½ä¸ä¼šå‘ç”Ÿï¼›ä½†æ˜¯ï¼Œå®ƒç«Ÿç„¶æ‰§è¡Œäº†ï¼</p><p>â¬‡ï¸ å®é™…ä¸Šï¼šå½“ p ç‚¹å‡»æ—¶ï¼Œæ›´æ”¹äº†å“åº”å¼æ•°æ® bol çš„å€¼ï¼Œç„¶åå½“å‰<strong>å‰¯ä½œç”¨å‡½æ•°ç«‹å³é‡æ–°æ‰§è¡Œ</strong>ï¼Œä¹Ÿå°±æ˜¯æ›´æ–°æ¸²æŸ“ä¼šæ‰§è¡Œï¼Œè¿™æ—¶å€™ç”±äº bol.value çš„å€¼å·²ç»æ˜¯ trueï¼Œä¼šç»™ div å…ƒç´ ç»‘å®šå¯¹åº”çš„äº‹ä»¶å¤„ç†å‡½æ•°ã€‚å½“æ›´æ–°åŠ¨ä½œå®Œæˆä¹‹åï¼Œç‚¹å‡»äº‹ä»¶æ‰ä» p å…ƒç´ å†’æ³¡åˆ°çˆ¶çº§ div å…ƒç´ ï¼Œæ­¤æ—¶çš„ div åœ¨æ›´æ–°åå·²ç»ç»‘å®šäº†äº‹ä»¶å¤„ç†å‡½æ•°ï¼Œè§¦å‘æ‰§è¡Œã€‚</p><p><img src="https://raw.githubusercontent.com/caffreygo/static/main/blog/Vuejs3/eventBinding.png" alt=""></p><p>æ‰€ä»¥ï¼š<strong>div å…ƒç´ ç»‘å®šäº‹ä»¶å¤„ç†å‡½æ•°å‘ç”Ÿåœ¨äº‹ä»¶å†’æ³¡ä¹‹å‰</strong>ã€‚</p><h3 id="å¤„ç†" tabindex="-1"><a class="header-anchor" href="#å¤„ç†" aria-hidden="true">#</a> å¤„ç†</h3><p>ğŸ› æˆ‘ä»¬å¯ä»¥è€ƒè™‘æŠŠäº‹ä»¶çš„ç»‘å®šåŠ¨ä½œæŒªåˆ°äº‹ä»¶å†’æ³¡ä¹‹åï¼Œä½†æ˜¯è¿™ä¸ªæƒ³æ³•æ˜¯ä¸å¯é çš„ï¼Œå› ä¸ºæˆ‘ä»¬æ— æ³•åˆ¤æ–­äº‹ä»¶å†’æ³¡æ˜¯å¦å®Œæˆï¼Œå·²ç»å®Œæˆåˆ°ä»€ä¹ˆç¨‹åº¦ã€‚</p><p>ğŸ› å¦å¤–ï¼Œè™½ç„¶ Vue.js çš„æ›´æ–°æ˜¯åœ¨ä¸€ä¸ªå¼‚æ­¥ä»»åŠ¡é˜Ÿåˆ—å½“ä¸­è¿›è¡Œçš„ï¼Œä½†æ˜¯å¾®ä»»åŠ¡ä¼š<strong>ç©¿æ’</strong>åœ¨ç”±äº‹ä»¶å†’æ³¡è§¦å‘çš„å¤šä¸ªäº‹ä»¶å¤„ç†å‡½æ•°ä¹‹é—´è¢«æ‰§è¡Œã€‚å› æ­¤ï¼Œå³ä½¿æŠŠç»‘å®šäº‹ä»¶çš„åŠ¨ä½œæ”¾åˆ°å¾®ä»»åŠ¡ä¸­ï¼Œä¹Ÿæ— æ³•é¿å…è¿™ä¸ªé—®é¢˜ã€‚</p><p>ğŸ“ äº‹ä»¶è§¦å‘çš„æ—¶é—´æ˜¯æ—©äºäº‹ä»¶å¤„ç†å‡½æ•°è¢«ç»‘å®šçš„æ—¶é—´çš„ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œè¿™ä¸ªäº‹ä»¶è§¦å‘çš„æ—¶å€™ï¼Œç›®æ ‡å…ƒç´ ï¼ˆdivï¼‰ä¸Šè¿˜æ²¡æœ‰ç»‘å®šç›¸å…³çš„äº‹ä»¶å¤„ç†å‡½æ•°ã€‚</p><p>ğŸš€ å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥ï¼š<strong>å±è”½æ‰€ä»¥ç»‘å®šæ—¶é—´æ™šäºäº‹ä»¶è§¦å‘æ—¶é—´çš„äº‹ä»¶å¤„ç†å‡½æ•°çš„æ‰§è¡Œ</strong>ã€‚</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token function">patchProps</span><span class="token punctuation">(</span><span class="token parameter">el<span class="token punctuation">,</span> key<span class="token punctuation">,</span> prevValue<span class="token punctuation">,</span> nextValue</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">^on</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">const</span> invokers <span class="token operator">=</span> el<span class="token punctuation">.</span>_vei <span class="token operator">||</span> <span class="token punctuation">(</span>el<span class="token punctuation">.</span>_vei <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>\n    <span class="token keyword">let</span> invoker <span class="token operator">=</span> invokers<span class="token punctuation">[</span>key<span class="token punctuation">]</span>\n    <span class="token keyword">const</span> name <span class="token operator">=</span> key<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toLowerCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token keyword">if</span> <span class="token punctuation">(</span>nextValue<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>invoker<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        invoker <span class="token operator">=</span> el<span class="token punctuation">.</span>_vei<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>\n          <span class="token comment">// å¦‚æœäº‹ä»¶è§¦å‘çš„æ—¶é—´æ—©äºäº‹ä»¶ç»‘å®šçš„æ—¶é—´ï¼Œreturn</span>\n          <span class="token keyword">if</span> <span class="token punctuation">(</span>e<span class="token punctuation">.</span>timeStamp <span class="token operator">&lt;</span> invoker<span class="token punctuation">.</span>attached<span class="token punctuation">)</span> <span class="token keyword">return</span>\n          <span class="token keyword">if</span> <span class="token punctuation">(</span>Array<span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span>invoker<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n            invoker<span class="token punctuation">.</span>value<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">fn</span> <span class="token operator">=&gt;</span> <span class="token function">fn</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">)</span>\n          <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>\n            invoker<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span>\n          <span class="token punctuation">}</span>\n        <span class="token punctuation">}</span>\n        invoker<span class="token punctuation">.</span>value <span class="token operator">=</span> nextValue\n        <span class="token comment">// æ·»åŠ  invoker.attached å±æ€§ï¼Œå­˜å‚¨äº‹ä»¶å¤„ç†å‡½æ•°è¢«ç»‘å®šçš„æ—¶é—´</span>\n        invoker<span class="token punctuation">.</span>attached <span class="token operator">=</span> performance<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n        el<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> invoker<span class="token punctuation">)</span>\n      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>\n        invoker<span class="token punctuation">.</span>value <span class="token operator">=</span> nextValue\n      <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>invoker<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      el<span class="token punctuation">.</span><span class="token function">removeEventListener</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> invoker<span class="token punctuation">)</span>\n    <span class="token punctuation">}</span>\n  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>key <span class="token operator">===</span> <span class="token string">&#39;class&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    el<span class="token punctuation">.</span>className <span class="token operator">=</span> nextValue <span class="token operator">||</span> <span class="token string">&#39;&#39;</span>\n  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">shouldSetAsProps</span><span class="token punctuation">(</span>el<span class="token punctuation">,</span> key<span class="token punctuation">,</span> nextValue<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">const</span> type <span class="token operator">=</span> <span class="token keyword">typeof</span> el<span class="token punctuation">[</span>key<span class="token punctuation">]</span>\n    <span class="token keyword">if</span> <span class="token punctuation">(</span>type <span class="token operator">===</span> <span class="token string">&#39;boolean&#39;</span> <span class="token operator">&amp;&amp;</span> nextValue <span class="token operator">===</span> <span class="token string">&#39;&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      el<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">true</span>\n    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>\n      el<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> nextValue\n    <span class="token punctuation">}</span>\n  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>\n    el<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> nextValue<span class="token punctuation">)</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n</code></pre><div class="highlight-lines"><br><br><br><br><br><br><br><br><br><div class="highlight-line">Â </div><br><br><br><br><br><br><br><br><div class="highlight-line">Â </div><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br></div><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br></div></div><p>æˆ‘ä»¬åªéœ€è¦ä¸ºä¼ªé€ çš„äº‹ä»¶å¤„ç†å‡½æ•°æ·»åŠ ä¸€ä¸ª attached å±æ€§ï¼Œç”¨æ¥å­˜å‚¨å½“å‰äº‹ä»¶å¤„ç†å‡½æ•°è¢«ç»‘å®šçš„æ—¶é—´ã€‚å› ä¸º event å¯¹è±¡çš„ timestamp å¯ä»¥è·å–åˆ°äº‹ä»¶å‘ç”Ÿçš„æ—¶é—´ï¼Œé‚£ä¹ˆå°±å¯ä»¥æ‹¦æˆªåˆ°æ—©äºäº‹ä»¶ç»‘å®šæ—¶é—´è§¦å‘çš„äº‹ä»¶ã€‚</p><p><em>æ ¹æ®æµè§ˆå™¨çš„ä¸åŒï¼Œe.timestamp å¯èƒ½æ˜¯ performance.nowï¼ˆé«˜ç²¾æ—¶é—´ï¼‰ï¼Œä¹Ÿå¯èƒ½ä¸æ˜¯ã€‚è¿™é‡Œåº”è¯¥è¦åšå…¼å®¹å¤„ç†ã€‚åœ¨ Chrome 49ã€Firefox 54ã€Opera 36 ä¹‹åçš„ç‰ˆæœ¬ä¸­ï¼Œe.timestamp éƒ½æ˜¯é«˜ç²¾æ—¶é—´ã€‚</em></p><h2 id="æ›´æ–°å­èŠ‚ç‚¹" tabindex="-1"><a class="header-anchor" href="#æ›´æ–°å­èŠ‚ç‚¹" aria-hidden="true">#</a> æ›´æ–°å­èŠ‚ç‚¹</h2><div class="custom-container tip"><p class="custom-container-title">å­èŠ‚ç‚¹ç±»å‹</p><ol><li>æ²¡æœ‰å­èŠ‚ç‚¹ï¼Œæ­¤æ—¶ vnode.children çš„å€¼ä¸º null</li><li>å…·æœ‰æ–‡æœ¬å­èŠ‚ç‚¹ï¼Œæ­¤æ—¶ vnode.children çš„å€¼ä¸ºå­—ç¬¦ä¸²ï¼Œä»£è¡¨æ–‡æœ¬å†…å®¹</li><li>å…¶ä»–æƒ…å†µï¼Œæ— è®ºæ˜¯å•ä¸ªå­èŠ‚ç‚¹ï¼Œè¿˜æ˜¯å¤šä¸ªå­èŠ‚ç‚¹ï¼ˆå¯èƒ½æ˜¯æ–‡æœ¬å’Œå…ƒç´ çš„æ··åˆï¼‰ï¼Œéƒ½å¯ä»¥ç”¨æ•°ç»„è¡¨ç¤º</li></ol></div>',29),b=(0,t._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t._)("pre",{class:"language-javascript"},[(0,t._)("code",null,[(0,t._)("span",{class:"token keyword"},"const"),(0,t.Uk)(" vnode "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n  type"),(0,t._)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"'div'"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)("\n  children"),(0,t._)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"null"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n")])]),(0,t._)("div",{class:"line-numbers"},[(0,t._)("span",{class:"line-number"},"1"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"2"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"3"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"4"),(0,t._)("br")])],-1),_=(0,t._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t._)("pre",{class:"language-javascript"},[(0,t._)("code",null,[(0,t._)("span",{class:"token keyword"},"const"),(0,t.Uk)(" vnode "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n  type"),(0,t._)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"'div'"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)("\n  children"),(0,t._)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"'Jerry Chen'"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n")])]),(0,t._)("div",{class:"line-numbers"},[(0,t._)("span",{class:"line-number"},"1"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"2"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"3"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"4"),(0,t._)("br")])],-1),m=(0,t._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t._)("pre",{class:"language-javascript"},[(0,t._)("code",null,[(0,t._)("span",{class:"token keyword"},"const"),(0,t.Uk)(" vnode "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n  type"),(0,t._)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"'div'"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)("\n  children"),(0,t._)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"["),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)(" type"),(0,t._)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"'p'"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token string"},"'Hello World'"),(0,t.Uk)("\n  "),(0,t._)("span",{class:"token punctuation"},"]"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n")])]),(0,t._)("div",{class:"line-numbers"},[(0,t._)("span",{class:"line-number"},"1"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"2"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"3"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"4"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"5"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"6"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"7"),(0,t._)("br")])],-1),d=(0,t._)("p",null,"å½“æ¸²æŸ“å™¨æ‰§è¡Œæ›´æ–°æ—¶ï¼Œå°±ä¼šå‡ºç°ä¹ç§å¯èƒ½ï¼š",-1),U=(0,t._)("p",null,[(0,t._)("img",{src:"https://raw.githubusercontent.com/caffreygo/static/main/blog/Vuejs3/patchChildren.png",alt:""})],-1),g=(0,t._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t._)("pre",{class:"language-javascript"},[(0,t._)("code",null,[(0,t._)("span",{class:"token keyword"},"function"),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"patchElement"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},[(0,t.Uk)("n1"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" n2")]),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n  "),(0,t._)("span",{class:"token keyword"},"const"),(0,t.Uk)(" el "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" n2"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("el "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" n1"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("el\n  "),(0,t._)("span",{class:"token keyword"},"const"),(0,t.Uk)(" oldProps "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" n1"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("props\n  "),(0,t._)("span",{class:"token keyword"},"const"),(0,t.Uk)(" newProps "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" n2"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("props\n  "),(0,t._)("span",{class:"token comment"},"// ç¬¬ä¸€æ­¥ï¼šæ›´æ–° propsï¼Œå±æ€§æ‰“è¡¥ä¸+å±æ€§å¸è½½"),(0,t.Uk)("\n  "),(0,t._)("span",{class:"token keyword"},"for"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token keyword"},"const"),(0,t.Uk)(" key "),(0,t._)("span",{class:"token keyword"},"in"),(0,t.Uk)(" newProps"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("newProps"),(0,t._)("span",{class:"token punctuation"},"["),(0,t.Uk)("key"),(0,t._)("span",{class:"token punctuation"},"]"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"!=="),(0,t.Uk)(" oldProps"),(0,t._)("span",{class:"token punctuation"},"["),(0,t.Uk)("key"),(0,t._)("span",{class:"token punctuation"},"]"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n      "),(0,t._)("span",{class:"token function"},"patchProps"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("el"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" key"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" oldProps"),(0,t._)("span",{class:"token punctuation"},"["),(0,t.Uk)("key"),(0,t._)("span",{class:"token punctuation"},"]"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" newProps"),(0,t._)("span",{class:"token punctuation"},"["),(0,t.Uk)("key"),(0,t._)("span",{class:"token punctuation"},"]"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n  "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n  "),(0,t._)("span",{class:"token keyword"},"for"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token keyword"},"const"),(0,t.Uk)(" key "),(0,t._)("span",{class:"token keyword"},"in"),(0,t.Uk)(" oldProps"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token operator"},"!"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("key "),(0,t._)("span",{class:"token keyword"},"in"),(0,t.Uk)(" newProps"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n      "),(0,t._)("span",{class:"token function"},"patchProps"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("el"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" key"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" oldProps"),(0,t._)("span",{class:"token punctuation"},"["),(0,t.Uk)("key"),(0,t._)("span",{class:"token punctuation"},"]"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"null"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n  "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n  "),(0,t._)("span",{class:"token comment"},"// ç¬¬äºŒæ­¥ï¼šæ›´æ–° children"),(0,t.Uk)("\n  "),(0,t._)("span",{class:"token function"},"patchChildren"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("n1"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" n2"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" el"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n")])]),(0,t._)("div",{class:"highlight-lines"},[(0,t._)("br"),(0,t._)("br"),(0,t._)("br"),(0,t._)("br"),(0,t._)("br"),(0,t._)("br"),(0,t._)("br"),(0,t._)("br"),(0,t._)("br"),(0,t._)("br"),(0,t._)("br"),(0,t._)("br"),(0,t._)("br"),(0,t._)("br"),(0,t._)("br"),(0,t._)("br"),(0,t._)("div",{class:"highlight-line"},"Â "),(0,t._)("br")]),(0,t._)("div",{class:"line-numbers"},[(0,t._)("span",{class:"line-number"},"1"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"2"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"3"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"4"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"5"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"6"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"7"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"8"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"9"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"10"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"11"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"12"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"13"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"14"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"15"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"16"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"17"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"18"),(0,t._)("br")])],-1),v=(0,t._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t._)("pre",{class:"language-javascript"},[(0,t._)("code",null,[(0,t._)("span",{class:"token keyword"},"function"),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"patchChildren"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},[(0,t.Uk)("n1"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" n2"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" container")]),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n  "),(0,t._)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token keyword"},"typeof"),(0,t.Uk)(" n2"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("children "),(0,t._)("span",{class:"token operator"},"==="),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"'string'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("Array"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"isArray"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("n1"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("children"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n      n1"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("children"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"forEach"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},"c"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"=>"),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"unmount"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("c"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token function"},"setElementText"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("container"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" n2"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("children"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n  "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"else"),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("Array"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"isArray"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("n2"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("children"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("Array"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"isArray"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("n1"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("children"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n      n1"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("children"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"forEach"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},"c"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"=>"),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"unmount"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("c"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n      n2"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("children"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"forEach"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},"c"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"=>"),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"patch"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token keyword"},"null"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" c"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" container"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"else"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n      "),(0,t._)("span",{class:"token function"},"setElementText"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("container"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"''"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n      n2"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("children"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"forEach"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},"c"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"=>"),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"patch"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token keyword"},"null"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" c"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" container"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n  "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"else"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("Array"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"isArray"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("n1"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("children"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n      n1"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("children"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"forEach"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},"c"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"=>"),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"unmount"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("c"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"else"),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token keyword"},"typeof"),(0,t.Uk)(" n1"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("children "),(0,t._)("span",{class:"token operator"},"==="),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"'string'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n      "),(0,t._)("span",{class:"token function"},"setElementText"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("container"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"''"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n  "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n")])]),(0,t._)("div",{class:"line-numbers"},[(0,t._)("span",{class:"line-number"},"1"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"2"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"3"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"4"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"5"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"6"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"7"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"8"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"9"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"10"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"11"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"12"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"13"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"14"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"15"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"16"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"17"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"18"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"19"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"20"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"21"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"22"),(0,t._)("br")])],-1),h=(0,t.uE)('<h2 id="æ–‡æœ¬èŠ‚ç‚¹å’Œæ³¨é‡ŠèŠ‚ç‚¹" tabindex="-1"><a class="header-anchor" href="#æ–‡æœ¬èŠ‚ç‚¹å’Œæ³¨é‡ŠèŠ‚ç‚¹" aria-hidden="true">#</a> æ–‡æœ¬èŠ‚ç‚¹å’Œæ³¨é‡ŠèŠ‚ç‚¹</h2><p>è™šæ‹Ÿ DOM å¯ä»¥æè¿°æ›´å¤šçš„çœŸå® DOMï¼Œä»¥ä¸‹æ˜¯æ–‡æœ¬èŠ‚ç‚¹çš„è¡¨ç¤ºï¼š</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> Text <span class="token operator">=</span> <span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n<span class="token keyword">const</span> newVnode <span class="token operator">=</span> <span class="token punctuation">{</span>\n  type<span class="token operator">:</span> Text<span class="token punctuation">,</span>\n  children<span class="token operator">:</span> <span class="token string">&#39;Some Text&#39;</span>\n<span class="token punctuation">}</span>\nrenderer<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span>newVnode<span class="token punctuation">,</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&#39;#app&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>é‚£ä¹ˆåœ¨ patch å‡½æ•°ä¸­ï¼Œæˆ‘ä»¬å°±å¯ä»¥å¢åŠ ä¸€ä¸ªåˆ¤æ–­åˆ†æ”¯æ¥å¤„ç† vnode.type ä¸ºæ–‡æœ¬çš„æƒ…å†µï¼š</p>',4),y=(0,t._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t._)("pre",{class:"language-javascript"},[(0,t._)("code",null,[(0,t._)("span",{class:"token keyword"},"function"),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"patch"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},[(0,t.Uk)("n1"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" n2"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" container")]),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n  "),(0,t._)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("n1 "),(0,t._)("span",{class:"token operator"},"&&"),(0,t.Uk)(" n1"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("type "),(0,t._)("span",{class:"token operator"},"!=="),(0,t.Uk)(" n2"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("type"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token function"},"unmount"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("n1"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n    n1 "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"null"),(0,t.Uk)("\n  "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n\n  "),(0,t._)("span",{class:"token keyword"},"const"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)(" type "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" n2\n\n  "),(0,t._)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token keyword"},"typeof"),(0,t.Uk)(" type "),(0,t._)("span",{class:"token operator"},"==="),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"'string'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token operator"},"!"),(0,t.Uk)("n1"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n      "),(0,t._)("span",{class:"token function"},"mountElement"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("n2"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" container"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"else"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n      "),(0,t._)("span",{class:"token function"},"patchElement"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("n1"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" n2"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n  "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"else"),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("type "),(0,t._)("span",{class:"token operator"},"==="),(0,t.Uk)(" Text"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token comment"},"// å¦‚æœæ²¡æœ‰æ—§èŠ‚ç‚¹ï¼Œåˆ™è¿›è¡ŒæŒ‚è½½"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token operator"},"!"),(0,t.Uk)("n1"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n      "),(0,t._)("span",{class:"token comment"},"// æ–‡æœ¬åˆ›å»ºä¸æ’å…¥"),(0,t.Uk)("\n      "),(0,t._)("span",{class:"token keyword"},"const"),(0,t.Uk)(" el "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" n2"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("el "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"createText"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("n2"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("children"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n      "),(0,t._)("span",{class:"token function"},"insert"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("el"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" container"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"else"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n      "),(0,t._)("span",{class:"token comment"},"// å¦‚æœæ—§ vnode å­˜åœ¨ï¼Œç›´æ¥æ›´æ–°å…¶æ–‡æœ¬å†…å®¹å³å¯"),(0,t.Uk)("\n      "),(0,t._)("span",{class:"token keyword"},"const"),(0,t.Uk)(" el "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" n2"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("el "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" n1"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("el\n      "),(0,t._)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("n2"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("children "),(0,t._)("span",{class:"token operator"},"!=="),(0,t.Uk)(" n1"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("children"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token function"},"setText"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("el"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" n2"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("children"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n      "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n  "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n")])]),(0,t._)("div",{class:"highlight-lines"},[(0,t._)("br"),(0,t._)("br"),(0,t._)("br"),(0,t._)("br"),(0,t._)("br"),(0,t._)("br"),(0,t._)("br"),(0,t._)("br"),(0,t._)("br"),(0,t._)("br"),(0,t._)("br"),(0,t._)("br"),(0,t._)("br"),(0,t._)("br"),(0,t._)("div",{class:"highlight-line"},"Â "),(0,t._)("br"),(0,t._)("br"),(0,t._)("br"),(0,t._)("br"),(0,t._)("br"),(0,t._)("br"),(0,t._)("br"),(0,t._)("br"),(0,t._)("br"),(0,t._)("br"),(0,t._)("br"),(0,t._)("br"),(0,t._)("br"),(0,t._)("br")]),(0,t._)("div",{class:"line-numbers"},[(0,t._)("span",{class:"line-number"},"1"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"2"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"3"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"4"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"5"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"6"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"7"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"8"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"9"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"10"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"11"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"12"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"13"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"14"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"15"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"16"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"17"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"18"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"19"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"20"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"21"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"22"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"23"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"24"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"25"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"26"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"27"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"28"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"29"),(0,t._)("br")])],-1),f=(0,t._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t._)("pre",{class:"language-javascript"},[(0,t._)("code",null,[(0,t._)("span",{class:"token keyword"},"const"),(0,t.Uk)(" renderer "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"createRenderer"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n  "),(0,t._)("span",{class:"token function"},"createElement"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},"tag"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token keyword"},"return"),(0,t.Uk)(" document"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"createElement"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("tag"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n  "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)("\n  "),(0,t._)("span",{class:"token function"},"setElementText"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},[(0,t.Uk)("el"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" text")]),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    el"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("textContent "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" text\n  "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)("\n  "),(0,t._)("span",{class:"token function"},"insert"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},[(0,t.Uk)("el"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" parent"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" anchor "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"null")]),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    parent"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"insertBefore"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("el"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" anchor"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n  "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)("\n  "),(0,t._)("span",{class:"token comment"},"// åˆ›å»ºä¸€ä¸ªæ–‡æœ¬èŠ‚ç‚¹å¹¶è¿”å›"),(0,t.Uk)("\n  "),(0,t._)("span",{class:"token function"},"createText"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},"text"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token keyword"},"return"),(0,t.Uk)(" document"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"createTextNode"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("text"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n  "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)("\n  "),(0,t._)("span",{class:"token comment"},"// æ›´æ–° DOM æ–‡æœ¬å†…å®¹"),(0,t.Uk)("\n  "),(0,t._)("span",{class:"token function"},"setText"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},[(0,t.Uk)("el"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" text")]),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    el"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("nodeValue "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" text\n  "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)("\n  "),(0,t._)("span",{class:"token function"},"patchProps"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},[(0,t.Uk)("el"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" key"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" prevValue"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" nextValue")]),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)(),(0,t._)("span",{class:"token comment"},"/*...*/"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n")])]),(0,t._)("div",{class:"line-numbers"},[(0,t._)("span",{class:"line-number"},"1"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"2"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"3"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"4"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"5"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"6"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"7"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"8"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"9"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"10"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"11"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"12"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"13"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"14"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"15"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"16"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"17"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"18"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"19"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"20"),(0,t._)("br")])],-1),w=(0,t._)("h2",{id:"fragment",tabindex:"-1"},[(0,t._)("a",{class:"header-anchor",href:"#fragment","aria-hidden":"true"},"#"),(0,t.Uk)(" Fragment")],-1),x=(0,t._)("p",null,"Fragmentï¼ˆç‰‡æ®µï¼‰æ˜¯Vue.js 3 ä¸­æ–°å¢çš„ä¸€ä¸ª vnode ç±»å‹ï¼Œå¯ä»¥é€šè¿‡å®ƒæè¿°å¤šæ ¹èŠ‚ç‚¹æ¨¡æ¿ã€‚å¯¹äºFragment ç±»å‹çš„ vnode æ¥è¯´ï¼Œå®ƒçš„ children å­˜å‚¨çš„å†…å®¹å°±æ˜¯æ¨¡æ¿ä¸­æ‰€æœ‰æ ¹èŠ‚ç‚¹ï¼š",-1),j=(0,t._)("div",{class:"language-html ext-html line-numbers-mode"},[(0,t._)("pre",{class:"language-html"},[(0,t._)("code",null,[(0,t._)("span",{class:"token tag"},[(0,t._)("span",{class:"token tag"},[(0,t._)("span",{class:"token punctuation"},"<"),(0,t.Uk)("template")]),(0,t._)("span",{class:"token punctuation"},">")]),(0,t.Uk)("\n  "),(0,t._)("span",{class:"token tag"},[(0,t._)("span",{class:"token tag"},[(0,t._)("span",{class:"token punctuation"},"<"),(0,t.Uk)("li")]),(0,t._)("span",{class:"token punctuation"},">")]),(0,t.Uk)("1"),(0,t._)("span",{class:"token tag"},[(0,t._)("span",{class:"token tag"},[(0,t._)("span",{class:"token punctuation"},"</"),(0,t.Uk)("li")]),(0,t._)("span",{class:"token punctuation"},">")]),(0,t.Uk)("\n  "),(0,t._)("span",{class:"token tag"},[(0,t._)("span",{class:"token tag"},[(0,t._)("span",{class:"token punctuation"},"<"),(0,t.Uk)("li")]),(0,t._)("span",{class:"token punctuation"},">")]),(0,t.Uk)("2"),(0,t._)("span",{class:"token tag"},[(0,t._)("span",{class:"token tag"},[(0,t._)("span",{class:"token punctuation"},"</"),(0,t.Uk)("li")]),(0,t._)("span",{class:"token punctuation"},">")]),(0,t.Uk)("\n  "),(0,t._)("span",{class:"token tag"},[(0,t._)("span",{class:"token tag"},[(0,t._)("span",{class:"token punctuation"},"<"),(0,t.Uk)("li")]),(0,t._)("span",{class:"token punctuation"},">")]),(0,t.Uk)("3"),(0,t._)("span",{class:"token tag"},[(0,t._)("span",{class:"token tag"},[(0,t._)("span",{class:"token punctuation"},"</"),(0,t.Uk)("li")]),(0,t._)("span",{class:"token punctuation"},">")]),(0,t.Uk)("\n"),(0,t._)("span",{class:"token tag"},[(0,t._)("span",{class:"token tag"},[(0,t._)("span",{class:"token punctuation"},"</"),(0,t.Uk)("template")]),(0,t._)("span",{class:"token punctuation"},">")]),(0,t.Uk)("\n")])]),(0,t._)("div",{class:"line-numbers"},[(0,t._)("span",{class:"line-number"},"1"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"2"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"3"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"4"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"5"),(0,t._)("br")])],-1),A=(0,t._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t._)("pre",{class:"language-javascript"},[(0,t._)("code",null,[(0,t._)("span",{class:"token keyword"},"const"),(0,t.Uk)(" Fragment "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"Symbol"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token keyword"},"const"),(0,t.Uk)(" vnode "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n  type"),(0,t._)("span",{class:"token operator"},":"),(0,t.Uk)(" Fragment"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)("\n  children"),(0,t._)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"["),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)(" type"),(0,t._)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"'li'"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" children"),(0,t._)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"'1'"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)(" type"),(0,t._)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"'li'"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" children"),(0,t._)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"'2'"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)(" type"),(0,t._)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"'li'"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" children"),(0,t._)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"'3'"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n  "),(0,t._)("span",{class:"token punctuation"},"]"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n")])]),(0,t._)("div",{class:"line-numbers"},[(0,t._)("span",{class:"line-number"},"1"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"2"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"3"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"4"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"5"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"6"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"7"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"8"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"9"),(0,t._)("br")])],-1),M=(0,t._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t._)("pre",{class:"language-javascript"},[(0,t._)("code",null,[(0,t._)("span",{class:"token keyword"},"function"),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"patch"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},[(0,t.Uk)("n1"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" n2"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" container")]),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n  "),(0,t._)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("n1 "),(0,t._)("span",{class:"token operator"},"&&"),(0,t.Uk)(" n1"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("type "),(0,t._)("span",{class:"token operator"},"!=="),(0,t.Uk)(" n2"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("type"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token function"},"unmount"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("n1"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n    n1 "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"null"),(0,t.Uk)("\n  "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n\n  "),(0,t._)("span",{class:"token keyword"},"const"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)(" type "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" n2\n\n  "),(0,t._)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token keyword"},"typeof"),(0,t.Uk)(" type "),(0,t._)("span",{class:"token operator"},"==="),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"'string'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token operator"},"!"),(0,t.Uk)("n1"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n      "),(0,t._)("span",{class:"token function"},"mountElement"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("n2"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" container"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"else"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n      "),(0,t._)("span",{class:"token function"},"patchElement"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("n1"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" n2"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n  "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"else"),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("type "),(0,t._)("span",{class:"token operator"},"==="),(0,t.Uk)(" Text"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token operator"},"!"),(0,t.Uk)("n1"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n      "),(0,t._)("span",{class:"token keyword"},"const"),(0,t.Uk)(" el "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" n2"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("el "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"createText"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("n2"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("children"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n      "),(0,t._)("span",{class:"token function"},"insert"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("el"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" container"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"else"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n      "),(0,t._)("span",{class:"token keyword"},"const"),(0,t.Uk)(" el "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" n2"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("el "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" n1"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("el\n      "),(0,t._)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("n2"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("children "),(0,t._)("span",{class:"token operator"},"!=="),(0,t.Uk)(" n1"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("children"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token function"},"setText"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("el"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" n2"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("children"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n      "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n  "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"else"),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("type "),(0,t._)("span",{class:"token operator"},"==="),(0,t.Uk)(" Fragment"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token operator"},"!"),(0,t.Uk)("n1"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n      "),(0,t._)("span",{class:"token comment"},"// æ—§ vnode ä¸å­˜åœ¨ï¼Œå°† Fragment çš„ children é€ä¸ªæŒ‚è½½"),(0,t.Uk)("\n      n2"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("children"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"forEach"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},"c"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"=>"),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"patch"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token keyword"},"null"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" c"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" container"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"else"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n      "),(0,t._)("span",{class:"token comment"},"// æ—§ vnode å­˜åœ¨ï¼Œæ›´æ–° Fragment çš„ children"),(0,t.Uk)("\n      "),(0,t._)("span",{class:"token function"},"patchChildren"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("n1"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" n2"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" container"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n  "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n")])]),(0,t._)("div",{class:"highlight-lines"},[(0,t._)("br"),(0,t._)("br"),(0,t._)("br"),(0,t._)("br"),(0,t._)("br"),(0,t._)("br"),(0,t._)("br"),(0,t._)("br"),(0,t._)("br"),(0,t._)("br"),(0,t._)("br"),(0,t._)("br"),(0,t._)("br"),(0,t._)("br"),(0,t._)("br"),(0,t._)("br"),(0,t._)("br"),(0,t._)("br"),(0,t._)("br"),(0,t._)("br"),(0,t._)("br"),(0,t._)("br"),(0,t._)("br"),(0,t._)("br"),(0,t._)("div",{class:"highlight-line"},"Â "),(0,t._)("div",{class:"highlight-line"},"Â "),(0,t._)("div",{class:"highlight-line"},"Â "),(0,t._)("div",{class:"highlight-line"},"Â "),(0,t._)("div",{class:"highlight-line"},"Â "),(0,t._)("div",{class:"highlight-line"},"Â "),(0,t._)("div",{class:"highlight-line"},"Â "),(0,t._)("div",{class:"highlight-line"},"Â "),(0,t._)("br"),(0,t._)("br")]),(0,t._)("div",{class:"line-numbers"},[(0,t._)("span",{class:"line-number"},"1"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"2"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"3"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"4"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"5"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"6"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"7"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"8"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"9"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"10"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"11"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"12"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"13"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"14"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"15"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"16"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"17"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"18"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"19"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"20"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"21"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"22"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"23"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"24"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"25"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"26"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"27"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"28"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"29"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"30"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"31"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"32"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"33"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"34"),(0,t._)("br")])],-1),q=(0,t._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t._)("pre",{class:"language-javascript"},[(0,t._)("code",null,[(0,t._)("span",{class:"token keyword"},"function"),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"unmount"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},"vnode"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n  "),(0,t._)("span",{class:"token comment"},"// Fragment çš„å¤„ç†"),(0,t.Uk)("\n  "),(0,t._)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("vnode"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("type "),(0,t._)("span",{class:"token operator"},"==="),(0,t.Uk)(" Fragment"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    vnode"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("children"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"forEach"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},"c"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"=>"),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"unmount"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("c"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token keyword"},"return"),(0,t.Uk)("\n  "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n  "),(0,t._)("span",{class:"token keyword"},"const"),(0,t.Uk)(" parent "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" vnode"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("el"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("parentNode\n  "),(0,t._)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("parent"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    parent"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"removeChild"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("vnode"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("el"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n  "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n")])]),(0,t._)("div",{class:"line-numbers"},[(0,t._)("span",{class:"line-number"},"1"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"2"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"3"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"4"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"5"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"6"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"7"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"8"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"9"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"10"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"11"),(0,t._)("br")])],-1),E=(0,t._)("p",null,"å½“å¸è½½ Fragment ç±»å‹çš„è™šæ‹ŸèŠ‚ç‚¹æ—¶ï¼Œç”±äº Fragment æœ¬èº«å¹¶ä¸ä¼šæ¸²æŸ“ä»»ä½•çœŸå® DOMï¼Œæ‰€ä»¥åªéœ€è¦éå†å®ƒçš„ children æ•°ç»„é€ä¸€å¸è½½å³å¯",-1),V={render:function(n,s){const a=(0,t.up)("CodeGroupItem"),V=(0,t.up)("CodeGroup");return(0,t.wg)(),(0,t.iD)(t.HY,null,[p,(0,t.Wm)(V,null,{default:(0,t.w5)((()=>[(0,t.Wm)(a,{title:"åŸå§‹ vnode"},{default:(0,t.w5)((()=>[e])),_:1}),(0,t.Wm)(a,{title:"normalizeClass"},{default:(0,t.w5)((()=>[o])),_:1}),(0,t.Wm)(a,{title:"ç»“æœ"},{default:(0,t.w5)((()=>[c])),_:1})])),_:1}),l,(0,t.Wm)(V,null,{default:(0,t.w5)((()=>[(0,t.Wm)(a,{title:"mountElement å¤„ç†"},{default:(0,t.w5)((()=>[u])),_:1}),(0,t.Wm)(a,{title:"unmount å°è£…"},{default:(0,t.w5)((()=>[i])),_:1}),(0,t.Wm)(a,{title:"render è°ƒç”¨"},{default:(0,t.w5)((()=>[k])),_:1})])),_:1}),r,(0,t.Wm)(V,null,{default:(0,t.w5)((()=>[(0,t.Wm)(a,{title:"Null"},{default:(0,t.w5)((()=>[b])),_:1}),(0,t.Wm)(a,{title:"String"},{default:(0,t.w5)((()=>[_])),_:1}),(0,t.Wm)(a,{title:"Array"},{default:(0,t.w5)((()=>[m])),_:1})])),_:1}),d,U,(0,t.Wm)(V,null,{default:(0,t.w5)((()=>[(0,t.Wm)(a,{title:"patchElement"},{default:(0,t.w5)((()=>[g])),_:1}),(0,t.Wm)(a,{title:"patchChildren"},{default:(0,t.w5)((()=>[v])),_:1})])),_:1}),h,(0,t.Wm)(V,null,{default:(0,t.w5)((()=>[(0,t.Wm)(a,{title:"patch"},{default:(0,t.w5)((()=>[y])),_:1}),(0,t.Wm)(a,{title:"API æŠ½è±¡"},{default:(0,t.w5)((()=>[f])),_:1})])),_:1}),w,x,(0,t.Wm)(V,null,{default:(0,t.w5)((()=>[(0,t.Wm)(a,{title:"å¤šæ ¹èŠ‚ç‚¹æ¨¡æ¿"},{default:(0,t.w5)((()=>[j])),_:1}),(0,t.Wm)(a,{title:"vnode è¡¨ç¤º"},{default:(0,t.w5)((()=>[A])),_:1}),(0,t.Wm)(a,{title:"patch å‡½æ•°å¤„ç†"},{default:(0,t.w5)((()=>[M])),_:1}),(0,t.Wm)(a,{title:"unmount æ”¯æŒ"},{default:(0,t.w5)((()=>[q,E])),_:1})])),_:1})],64)}}}}]);